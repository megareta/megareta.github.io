!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=function(t,r){return void 0===r&&(r="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(r),r}:e(jQuery)}(function(e){"use strict";function t(t){var r=t.data;t.isDefaultPrevented()||(t.preventDefault(),e(t.target).closest("form").ajaxSubmit(r))}function r(t){var r=t.target,a=e(r);if(!a.is("[type=submit],[type=image]")){var n=a.closest("[type=submit]");if(0===n.length)return;r=n[0]}var i=r.form;if(i.clk=r,"image"===r.type)if(void 0!==t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var o=a.offset();i.clk_x=t.pageX-o.left,i.clk_y=t.pageY-o.top}else i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)}function a(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}var n=/\r?\n/g,i={};i.fileapi=void 0!==e('<input type="file">').get(0).files,i.formdata=void 0!==window.FormData;var o=!!e.fn.prop;e.fn.attr2=function(){if(!o)return this.attr.apply(this,arguments);var e=this.prop.apply(this,arguments);return e&&e.jquery||"string"==typeof e?e:this.attr.apply(this,arguments)},e.fn.ajaxSubmit=function(t,r,n,s){function u(r){var a,n,i=e.param(r,t.traditional).split("&"),o=i.length,s=[];for(a=0;a<o;a++)i[a]=i[a].replace(/\+/g," "),n=i[a].split("="),s.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return s}function c(r){function n(e){var t=null;try{e.contentWindow&&(t=e.contentWindow.document)}catch(e){a("cannot get iframe.contentWindow document: "+e)}if(t)return t;try{t=e.contentDocument?e.contentDocument:e.document}catch(r){a("cannot get iframe.contentDocument: "+r),t=e.document}return t}function i(){function t(){try{var e=n(v).readyState;a("state = "+e),e&&"uninitialized"===e.toLowerCase()&&setTimeout(t,50)}catch(e){a("Server abort: ",e," (",e.name,")"),s(L),j&&clearTimeout(j),j=void 0}}var r=p.attr2("target"),i=p.attr2("action"),o=p.attr("enctype")||p.attr("encoding")||"multipart/form-data";w.setAttribute("target",m),l&&!/post/i.test(l)||w.setAttribute("method","POST"),i!==f.url&&w.setAttribute("action",f.url),f.skipEncodingOverride||l&&!/post/i.test(l)||p.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),f.timeout&&(j=setTimeout(function(){T=!0,s(A)},f.timeout));var u=[];try{if(f.extraData)for(var c in f.extraData)f.extraData.hasOwnProperty(c)&&(e.isPlainObject(f.extraData[c])&&f.extraData[c].hasOwnProperty("name")&&f.extraData[c].hasOwnProperty("value")?u.push(e('<input type="hidden" name="'+f.extraData[c].name+'">',k).val(f.extraData[c].value).appendTo(w)[0]):u.push(e('<input type="hidden" name="'+c+'">',k).val(f.extraData[c]).appendTo(w)[0]));f.iframeTarget||h.appendTo(D),v.attachEvent?v.attachEvent("onload",s):v.addEventListener("load",s,!1),setTimeout(t,15);try{w.submit()}catch(e){document.createElement("form").submit.apply(w)}}finally{w.setAttribute("action",i),w.setAttribute("enctype",o),r?w.setAttribute("target",r):p.removeAttr("target"),e(u).remove()}}function s(t){if(!x.aborted&&!X){if((O=n(v))||(a("cannot access response document"),t=L),t===A&&x)return x.abort("timeout"),void S.reject(x,"timeout");if(t===L&&x)return x.abort("server abort"),void S.reject(x,"error","server abort");if(O&&O.location.href!==f.iframeSrc||T){v.detachEvent?v.detachEvent("onload",s):v.removeEventListener("load",s,!1);var r,i="success";try{if(T)throw"timeout";var o="xml"===f.dataType||O.XMLDocument||e.isXMLDoc(O);if(a("isXml="+o),!o&&window.opera&&(null===O.body||!O.body.innerHTML)&&--C)return a("requeing onLoad callback, DOM not available"),void setTimeout(s,250);var u=O.body?O.body:O.documentElement;x.responseText=u?u.innerHTML:null,x.responseXML=O.XMLDocument?O.XMLDocument:O,o&&(f.dataType="xml"),x.getResponseHeader=function(e){return{"content-type":f.dataType}[e.toLowerCase()]},u&&(x.status=Number(u.getAttribute("status"))||x.status,x.statusText=u.getAttribute("statusText")||x.statusText);var c=(f.dataType||"").toLowerCase(),l=/(json|script|text)/.test(c);if(l||f.textarea){var p=O.getElementsByTagName("textarea")[0];if(p)x.responseText=p.value,x.status=Number(p.getAttribute("status"))||x.status,x.statusText=p.getAttribute("statusText")||x.statusText;else if(l){var m=O.getElementsByTagName("pre")[0],g=O.getElementsByTagName("body")[0];m?x.responseText=m.textContent?m.textContent:m.innerText:g&&(x.responseText=g.textContent?g.textContent:g.innerText)}}else"xml"===c&&!x.responseXML&&x.responseText&&(x.responseXML=q(x.responseText));try{M=N(x,c,f)}catch(e){i="parsererror",x.error=r=e||i}}catch(e){a("error caught: ",e),i="error",x.error=r=e||i}x.aborted&&(a("upload aborted"),i=null),x.status&&(i=x.status>=200&&x.status<300||304===x.status?"success":"error"),"success"===i?(f.success&&f.success.call(f.context,M,"success",x),S.resolve(x.responseText,"success",x),d&&e.event.trigger("ajaxSuccess",[x,f])):i&&(void 0===r&&(r=x.statusText),f.error&&f.error.call(f.context,x,i,r),S.reject(x,"error",r),d&&e.event.trigger("ajaxError",[x,f,r])),d&&e.event.trigger("ajaxComplete",[x,f]),d&&!--e.active&&e.event.trigger("ajaxStop"),f.complete&&f.complete.call(f.context,x,i),X=!0,f.timeout&&clearTimeout(j),setTimeout(function(){f.iframeTarget?h.attr("src",f.iframeSrc):h.remove(),x.responseXML=null},100)}}}var u,c,f,d,m,h,v,x,y,b,T,j,w=p[0],S=e.Deferred();if(S.abort=function(e){x.abort(e)},r)for(c=0;c<g.length;c++)u=e(g[c]),o?u.prop("disabled",!1):u.removeAttr("disabled");(f=e.extend(!0,{},e.ajaxSettings,t)).context=f.context||f,m="jqFormIO"+(new Date).getTime();var k=w.ownerDocument,D=p.closest("body");if(f.iframeTarget?(b=(h=e(f.iframeTarget,k)).attr2("name"))?m=b:h.attr2("name",m):(h=e('<iframe name="'+m+'" src="'+f.iframeSrc+'" />',k)).css({position:"absolute",top:"-1000px",left:"-1000px"}),v=h[0],x={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var r="timeout"===t?"timeout":"aborted";a("aborting upload... "+r),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(e){}h.attr("src",f.iframeSrc),x.error=r,f.error&&f.error.call(f.context,x,r,t),d&&e.event.trigger("ajaxError",[x,f,r]),f.complete&&f.complete.call(f.context,x,r)}},(d=f.global)&&0==e.active++&&e.event.trigger("ajaxStart"),d&&e.event.trigger("ajaxSend",[x,f]),f.beforeSend&&!1===f.beforeSend.call(f.context,x,f))return f.global&&e.active--,S.reject(),S;if(x.aborted)return S.reject(),S;(y=w.clk)&&(b=y.name)&&!y.disabled&&(f.extraData=f.extraData||{},f.extraData[b]=y.value,"image"===y.type&&(f.extraData[b+".x"]=w.clk_x,f.extraData[b+".y"]=w.clk_y));var A=1,L=2,F=e("meta[name=csrf-token]").attr("content"),E=e("meta[name=csrf-param]").attr("content");E&&F&&(f.extraData=f.extraData||{},f.extraData[E]=F),f.forceSync?i():setTimeout(i,10);var M,O,X,C=50,q=e.parseXML||function(e,t){return window.ActiveXObject?((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!==t.documentElement.nodeName?t:null},_=e.parseJSON||function(e){return window.eval("("+e+")")},N=function(t,r,a){var n=t.getResponseHeader("content-type")||"",i=("xml"===r||!r)&&n.indexOf("xml")>=0,o=i?t.responseXML:t.responseText;return i&&"parsererror"===o.documentElement.nodeName&&e.error&&e.error("parsererror"),a&&a.dataFilter&&(o=a.dataFilter(o,r)),"string"==typeof o&&(("json"===r||!r)&&n.indexOf("json")>=0?o=_(o):("script"===r||!r)&&n.indexOf("javascript")>=0&&e.globalEval(o)),o};return S}if(!this.length)return a("ajaxSubmit: skipping submit process - no element selected"),this;var l,f,d,p=this;"function"==typeof t?t={success:t}:"string"==typeof t||!1===t&&arguments.length>0?(t={url:t,data:r,dataType:n},"function"==typeof s&&(t.success=s)):void 0===t&&(t={}),l=t.method||t.type||this.attr2("method"),(d=(d="string"==typeof(f=t.url||this.attr2("action"))?e.trim(f):"")||window.location.href||"")&&(d=(d.match(/^([^#]+)/)||[])[1]),t=e.extend(!0,{url:d,success:e.ajaxSettings.success,type:l||e.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},t);var m={};if(this.trigger("form-pre-serialize",[this,t,m]),m.veto)return a("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(t.beforeSerialize&&!1===t.beforeSerialize(this,t))return a("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var h=t.traditional;void 0===h&&(h=e.ajaxSettings.traditional);var v,g=[],x=this.formToArray(t.semantic,g,t.filtering);if(t.data){var y=e.isFunction(t.data)?t.data(x):t.data;t.extraData=y,v=e.param(y,h)}if(t.beforeSubmit&&!1===t.beforeSubmit(x,this,t))return a("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[x,this,t,m]),m.veto)return a("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var b=e.param(x,h);v&&(b=b?b+"&"+v:v),"GET"===t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+b,t.data=null):t.data=b;var T=[];if(t.resetForm&&T.push(function(){p.resetForm()}),t.clearForm&&T.push(function(){p.clearForm(t.includeHidden)}),!t.dataType&&t.target){var j=t.success||function(){};T.push(function(r,a,n){var i=arguments,o=t.replaceTarget?"replaceWith":"html";e(t.target)[o](r).each(function(){j.apply(this,i)})})}else t.success&&(e.isArray(t.success)?e.merge(T,t.success):T.push(t.success));if(t.success=function(e,r,a){for(var n=t.context||this,i=0,o=T.length;i<o;i++)T[i].apply(n,[e,r,a||p,p])},t.error){var w=t.error;t.error=function(e,r,a){var n=t.context||this;w.apply(n,[e,r,a,p])}}if(t.complete){var S=t.complete;t.complete=function(e,r){var a=t.context||this;S.apply(a,[e,r,p])}}var k=e("input[type=file]:enabled",this).filter(function(){return""!==e(this).val()}).length>0,D="multipart/form-data",A=p.attr("enctype")===D||p.attr("encoding")===D,L=i.fileapi&&i.formdata;a("fileAPI :"+L);var F,E=(k||A)&&!L;!1!==t.iframe&&(t.iframe||E)?t.closeKeepAlive?e.get(t.closeKeepAlive,function(){F=c(x)}):F=c(x):F=(k||A)&&L?function(r){for(var a=new FormData,n=0;n<r.length;n++)a.append(r[n].name,r[n].value);if(t.extraData){var i=u(t.extraData);for(n=0;n<i.length;n++)i[n]&&a.append(i[n][0],i[n][1])}t.data=null;var o=e.extend(!0,{},e.ajaxSettings,t,{contentType:!1,processData:!1,cache:!1,type:l||"POST"});t.uploadProgress&&(o.xhr=function(){var r=e.ajaxSettings.xhr();return r.upload&&r.upload.addEventListener("progress",function(e){var r=0,a=e.loaded||e.position,n=e.total;e.lengthComputable&&(r=Math.ceil(a/n*100)),t.uploadProgress(e,a,n,r)},!1),r}),o.data=null;var s=o.beforeSend;return o.beforeSend=function(e,r){t.formData?r.data=t.formData:r.data=a,s&&s.call(this,e,r)},e.ajax(o)}(x):e.ajax(t),p.removeData("jqxhr").data("jqxhr",F);for(var M=0;M<g.length;M++)g[M]=null;return this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(n,i,o,s){if(("string"==typeof n||!1===n&&arguments.length>0)&&(n={url:n,data:i,dataType:o},"function"==typeof s&&(n.success=s)),n=n||{},n.delegation=n.delegation&&e.isFunction(e.fn.on),!n.delegation&&0===this.length){var u={s:this.selector,c:this.context};return!e.isReady&&u.s?(a("DOM not ready, queuing ajaxForm"),e(function(){e(u.s,u.c).ajaxForm(n)}),this):(a("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return n.delegation?(e(document).off("submit.form-plugin",this.selector,t).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,n,t).on("click.form-plugin",this.selector,n,r),this):this.ajaxFormUnbind().on("submit.form-plugin",n,t).on("click.form-plugin",n,r)},e.fn.ajaxFormUnbind=function(){return this.off("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t,r,a){var n=[];if(0===this.length)return n;var o,s=this[0],u=this.attr("id"),c=t||void 0===s.elements?s.getElementsByTagName("*"):s.elements;if(c&&(c=e.makeArray(c)),u&&(t||/(Edge|Trident)\//.test(navigator.userAgent))&&(o=e(':input[form="'+u+'"]').get()).length&&(c=(c||[]).concat(o)),!c||!c.length)return n;e.isFunction(a)&&(c=e.map(c,a));var l,f,d,p,m,h,v;for(l=0,h=c.length;l<h;l++)if(m=c[l],(d=m.name)&&!m.disabled)if(t&&s.clk&&"image"===m.type)s.clk===m&&(n.push({name:d,value:e(m).val(),type:m.type}),n.push({name:d+".x",value:s.clk_x},{name:d+".y",value:s.clk_y}));else if((p=e.fieldValue(m,!0))&&p.constructor===Array)for(r&&r.push(m),f=0,v=p.length;f<v;f++)n.push({name:d,value:p[f]});else if(i.fileapi&&"file"===m.type){r&&r.push(m);var g=m.files;if(g.length)for(f=0;f<g.length;f++)n.push({name:d,value:g[f],type:m.type});else n.push({name:d,value:"",type:m.type})}else null!==p&&void 0!==p&&(r&&r.push(m),n.push({name:d,value:p,type:m.type,required:m.required}));if(!t&&s.clk){var x=e(s.clk),y=x[0];(d=y.name)&&!y.disabled&&"image"===y.type&&(n.push({name:d,value:x.val()}),n.push({name:d+".x",value:s.clk_x},{name:d+".y",value:s.clk_y}))}return n},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var r=[];return this.each(function(){var a=this.name;if(a){var n=e.fieldValue(this,t);if(n&&n.constructor===Array)for(var i=0,o=n.length;i<o;i++)r.push({name:a,value:n[i]});else null!==n&&void 0!==n&&r.push({name:this.name,value:n})}}),e.param(r)},e.fn.fieldValue=function(t){for(var r=[],a=0,n=this.length;a<n;a++){var i=this[a],o=e.fieldValue(i,t);null===o||void 0===o||o.constructor===Array&&!o.length||(o.constructor===Array?e.merge(r,o):r.push(o))}return r},e.fieldValue=function(t,r){var a=t.name,i=t.type,o=t.tagName.toLowerCase();if(void 0===r&&(r=!0),r&&(!a||t.disabled||"reset"===i||"button"===i||("checkbox"===i||"radio"===i)&&!t.checked||("submit"===i||"image"===i)&&t.form&&t.form.clk!==t||"select"===o&&-1===t.selectedIndex))return null;if("select"===o){var s=t.selectedIndex;if(s<0)return null;for(var u=[],c=t.options,l="select-one"===i,f=l?s+1:c.length,d=l?s:0;d<f;d++){var p=c[d];if(p.selected&&!p.disabled){var m=p.value;if(m||(m=p.attributes&&p.attributes.value&&!p.attributes.value.specified?p.text:p.value),l)return m;u.push(m)}}return u}return e(t).val().replace(n,"\r\n")},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(t){var r=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,n=this.tagName.toLowerCase();r.test(a)||"textarea"===n?this.value="":"checkbox"===a||"radio"===a?this.checked=!1:"select"===n?this.selectedIndex=-1:"file"===a?/MSIE/.test(navigator.userAgent)?e(this).replaceWith(e(this).clone(!0)):e(this).val(""):t&&(!0===t&&/hidden/.test(a)||"string"==typeof t&&e(this).is(t))&&(this.value="")})},e.fn.resetForm=function(){return this.each(function(){var t=e(this),r=this.tagName.toLowerCase();switch(r){case"input":this.checked=this.defaultChecked;case"textarea":return this.value=this.defaultValue,!0;case"option":case"optgroup":var a=t.parents("select");return a.length&&a[0].multiple?"option"===r?this.selected=this.defaultSelected:t.find("option").resetForm():a.resetForm(),!0;case"select":return t.find("option").each(function(e){if(this.selected=this.defaultSelected,this.defaultSelected&&!t[0].multiple)return t[0].selectedIndex=e,!1}),!0;case"label":var n=e(t.attr("for")),i=t.find("input,select,textarea");return n[0]&&i.unshift(n[0]),i.resetForm(),!0;case"form":return("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset(),!0;default:return t.find("form,input,label,select,textarea").resetForm(),!0}})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var r=this.type;if("checkbox"===r||"radio"===r)this.checked=t;else if("option"===this.tagName.toLowerCase()){var a=e(this).parent("select");t&&a[0]&&"select-one"===a[0].type&&a.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1});
(function(e,t,n){typeof define=="function"&&define.amd?define(["jquery"],function(r){return n(r,e,t),r.mobile}):n(e.jQuery,e,t)})(this,document,function(e,t,n,r){(function(t){typeof define=="function"&&define.amd?define("ns",["jquery"],t):t(e)})(function(e){return e.mobile={version:"@VERSION"},e.mobile}),function(t){typeof define=="function"&&define.amd?define("data",["jquery","./ns"],t):t(e)}(function(e){var n={},i=e.find,s=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,o=/:jqmData\(([^)]*)\)/g;return e.extend(e.mobile,{ns:e.mobileBackcompat===!1?"ui-":"",getAttribute:function(n,r){var i;n=n.jquery?n[0]:n,n&&n.getAttribute&&(i=n.getAttribute("data-"+e.mobile.ns+r));try{i=i==="true"?!0:i==="false"?!1:i==="null"?null:+i+""===i?+i:s.test(i)?t.JSON.parse(i):i}catch(o){}return i},nsNormalizeDict:n,nsNormalize:function(t){return n[t]||(n[t]=e.camelCase(e.mobile.ns+t))},closestPageData:function(e){return e.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),e.fn.jqmData=function(t,n){var i;return typeof t!="undefined"&&(t&&(t=e.mobile.nsNormalize(t)),arguments.length<2||n===r?i=this.data(t):i=this.data(t,n)),i},e.jqmData=function(t,n,r){var i;return typeof n!="undefined"&&(i=e.data(t,n?e.mobile.nsNormalize(n):n,r)),i},e.fn.jqmRemoveData=function(t){return this.removeData(e.mobile.nsNormalize(t))},e.jqmRemoveData=function(t,n){return e.removeData(t,e.mobile.nsNormalize(n))},e.find=function(t,n,r,s){return t.indexOf(":jqmData")>-1&&(t=t.replace(o,"[data-"+(e.mobile.ns||"")+"$1]")),i.call(this,t,n,r,s)},e.extend(e.find,i),e.mobile}),function(t){typeof define=="function"&&define.amd?define("vmouse",["jquery"],t):t(e)}(function(e){function T(e){while(e&&typeof e.originalEvent!="undefined")e=e.originalEvent;return e}function N(t,n){var i=t.type,o,a,l,c,h,p,d,v,m;t=e.Event(t),t.type=n,o=t.originalEvent,a=u,i.search(/^(mouse|click)/)>-1&&(a=f);if(o)for(d=a.length;d;)c=a[--d],t[c]=o[c];i.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1);if(i.search(/^touch/)!==-1){l=T(o),i=l.touches,h=l.changedTouches,p=i&&i.length?i[0]:h&&h.length?h[0]:r;if(p)for(v=0,m=s.length;v<m;v++)c=s[v],t[c]=p[c]}return t}function C(n){var r={},i,s;while(n){i=e.data(n,t);for(s in i)i[s]&&(r[s]=r.hasVirtualBinding=!0);n=n.parentNode}return r}function k(n,r){var i;while(n){i=e.data(n,t);if(i&&(!r||i[r]))return n;n=n.parentNode}return null}function L(){g=!1}function A(){g=!0}function O(){E=0,v.length=0,m=!1,A()}function M(){L()}function _(){c&&(clearTimeout(c),c=0)}function D(){_(),c=setTimeout(function(){c=0,O()},e.vmouse.resetTimerDuration)}function P(t,n,r){var i;if(r&&r[t]||!r&&k(n.target,t))i=N(n,t),e(n.target).trigger(i);return i}function H(t){var n=e.data(t.target,i),r;t.type==="click"&&e.data(t.target,"lastTouchType")==="touchstart"&&setTimeout(function(){e.data(t.target,"lastTouchType")==="touchstart"&&(O(),delete e.data(t.target).lastTouchType,H(t))},e.vmouse.maximumTimeBetweenTouches),!m&&(!E||E!==n)&&(r=P("v"+t.type,t),r&&(r.isDefaultPrevented()&&t.preventDefault(),r.isPropagationStopped()&&t.stopPropagation(),r.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function B(t){var n=T(t).touches,r,s,o;n&&n.length===1&&(r=t.target,s=C(r),e.data(t.target,"lastTouchType",t.type),s.hasVirtualBinding&&(E=w++,e.data(r,i,E),_(),M(),d=!1,o=T(t).touches[0],h=o.pageX,p=o.pageY,P("vmouseover",t,s),P("vmousedown",t,s)))}function j(t){if(g)return;d||P("vmousecancel",t,C(t.target)),e.data(t.target,"lastTouchType",t.type),d=!0,D()}function F(t){if(g)return;var n=T(t).touches[0],r=d,i=e.vmouse.moveDistanceThreshold,s=C(t.target);e.data(t.target,"lastTouchType",t.type),d=d||Math.abs(n.pageX-h)>i||Math.abs(n.pageY-p)>i,d&&!r&&P("vmousecancel",t,s),P("vmousemove",t,s),D()}function I(t){if(g||e.data(t.target,"lastTouchType")===r)return;A(),delete e.data(t.target).lastTouchType;var n=C(t.target),i,s;P("vmouseup",t,n),d||(i=P("vclick",t,n),i&&i.isDefaultPrevented()&&(s=T(t).changedTouches[0],v.push({touchID:E,x:s.clientX,y:s.clientY}),m=!0)),P("vmouseout",t,n),d=!1,D()}function q(n){var r=e.data(n,t),i;if(r)for(i in r)if(r[i])return!0;return!1}function R(){}function U(n){var r=n.substr(1);return{setup:function(){q(this)||e.data(this,t,{});var i=e.data(this,t);i[n]=!0,l[n]=(l[n]||0)+1,l[n]===1&&b.bind(r,H),e(this).bind(r,R),y&&(l.touchstart=(l.touchstart||0)+1,l.touchstart===1&&b.bind("touchstart",B).bind("touchend",I).bind("touchmove",F).bind("scroll",j))},teardown:function(){--l[n],l[n]||b.unbind(r,H),y&&(--l.touchstart,l.touchstart||b.unbind("touchstart",B).unbind("touchmove",F).unbind("touchend",I).unbind("scroll",j));var i=e(this),s=e.data(this,t);s&&(s[n]=!1),i.unbind(r,R),q(this)||i.removeData(t)}}}var t="virtualMouseBindings",i="virtualTouchID",s="clientX clientY pageX pageY screenX screenY".split(" "),o="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),u="altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),a=e.event.mouseHooks?e.event.mouseHooks.props:[],f=u.concat(a),l={},c=0,h=0,p=0,d=!1,v=[],m=!1,g=!1,y="addEventListener"in n,b=e(n),w=1,E=0,S,x;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500,maximumTimeBetweenTouches:100};for(x=0;x<o.length;x++)e.event.special[o[x]]=U(o[x]);y&&n.addEventListener("click",function(t){var n=v.length,r=t.target,s,o,u,a,f,l;if(n){s=t.clientX,o=t.clientY,S=e.vmouse.clickDistanceThreshold,u=r;while(u){for(a=0;a<n;a++){f=v[a],l=0;if(u===r&&Math.abs(f.x-s)<S&&Math.abs(f.y-o)<S||e.data(u,i)===f.touchID){t.preventDefault(),t.stopPropagation();return}}u=u.parentNode}}},!0)}),function(t){typeof define=="function"&&define.amd?define("support/touch",["jquery","../ns"],t):t(e)}(function(e){var t={touch:"ontouchend"in n};return e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t),e.support}),function(t){typeof define=="function"&&define.amd?define("events/touch",["jquery","../vmouse","../support/touch"],t):t(e)}(function(e){function f(t,n,i,s){var o=i.type;i.type=n,s?e.event.trigger(i,r,t):e.event.dispatch.call(t,i),i.type=o}var i=e(n),s=e.mobile.support.touch,o=s?"touchstart":"mousedown",u=s?"touchend":"mouseup",a=s?"touchmove":"mousemove";return e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),r=!1;n.bind("vmousedown",function(s){function l(){u&&(n.bind("vclick",a),clearTimeout(u))}function c(){l(),n.unbind("vclick",a).unbind("vmouseup",l),i.unbind("vmousecancel",c)}r=!1;if(s.which&&s.which!==1)return!0;var o=s.target,u,a;a=function(e){c(),!r&&o===e.target?f(t,"tap",e):r&&e.preventDefault()},n.bind("vmouseup",l),i.bind("vmousecancel",c),u=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(r=!0),u=0,f(t,"taphold",e.Event("taphold",{target:o}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),i.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:t.devicePixelRatio>=2?15:30,verticalDistanceThreshold:t.devicePixelRatio>=2?15:30,getLocation:function(e){var n=t.pageXOffset,r=t.pageYOffset,i=e.clientX,s=e.clientY;if(e.pageY===0&&Math.floor(s)>Math.floor(e.pageY)||e.pageX===0&&Math.floor(i)>Math.floor(e.pageX))i-=n,s-=r;else if(s<e.pageY-r||i<e.pageX-n)i=e.pageX-n,s=e.pageY-r;return{x:i,y:s}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,r=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[r.x,r.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,r=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[r.x,r.y]}},handleSwipe:function(t,n,r,i){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var s=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return f(r,"swipe",e.Event("swipe",{target:i,swipestart:t,swipestop:n}),!0),f(r,s,e.Event(s,{target:i,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,r=e(n),s={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=s,s.start=function(t){if(e.event.special.swipe.eventInProgress)return;e.event.special.swipe.eventInProgress=!0;var r,o=e.event.special.swipe.start(t),f=t.target,l=!1;s.move=function(t){if(!o||t.isDefaultPrevented())return;r=e.event.special.swipe.stop(t),l||(l=e.event.special.swipe.handleSwipe(o,r,n,f),l&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(o.coords[0]-r.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault()},s.stop=function(){l=!0,e.event.special.swipe.eventInProgress=!1,i.off(a,s.move),s.move=null},i.on(a,s.move).one(u,s.stop)},r.on(o,s.start)},teardown:function(){var t,n;t=e.data(this,"mobile-events"),t&&(n=t.swipe,delete t.swipe,t.length--,t.length===0&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(o,n.start),n.move&&i.off(a,n.move),n.stop&&i.off(u,n.stop))}},e.each({taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}}),e.event.special}),function(t){typeof define=="function"&&define.amd?define("jquery-ui/version",["jquery"],t):t(e)}(function(e){return e.ui=e.ui||{},e.ui.version="1.12.1"}),function(t){typeof define=="function"&&define.amd?define("jquery-ui/widget",["jquery","./version"],t):t(e)}(function(e){var t=0,n=Array.prototype.slice;return e.cleanData=function(t){return function(n){var r,i,s;for(s=0;(i=n[s])!=null;s++)try{r=e._data(i,"events"),r&&r.remove&&e(i).triggerHandler("remove")}catch(o){}t(n)}}(e.cleanData),e.widget=function(t,n,r){var i,s,o,u={},a=t.split(".")[0];t=t.split(".")[1];var f=a+"-"+t;return r||(r=n,n=e.Widget),e.isArray(r)&&(r=e.extend.apply(null,[{}].concat(r))),e.expr[":"][f.toLowerCase()]=function(t){return!!e.data(t,f)},e[a]=e[a]||{},i=e[a][t],s=e[a][t]=function(e,t){if(!this._createWidget)return new s(e,t);arguments.length&&this._createWidget(e,t)},e.extend(s,i,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),o=new n,o.options=e.widget.extend({},o.options),e.each(r,function(t,r){if(!e.isFunction(r)){u[t]=r;return}u[t]=function(){function e(){return n.prototype[t].apply(this,arguments)}function i(e){return n.prototype[t].apply(this,e)}return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=i,s=r.apply(this,arguments),this._super=t,this._superApply=n,s}}()}),s.prototype=e.widget.extend(o,{widgetEventPrefix:i?o.widgetEventPrefix||t:t},u,{constructor:s,namespace:a,widgetName:t,widgetFullName:f}),i?(e.each(i._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,s,n._proto)}),delete i._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s),s},e.widget.extend=function(t){var i=n.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==r&&(e.isPlainObject(a)?t[u]=e.isPlainObject(t[u])?e.widget.extend({},t[u],a):e.widget.extend({},a):t[u]=a);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(o){var u=typeof o=="string",a=n.call(arguments,1),f=this;return u?!this.length&&o==="instance"?f=r:this.each(function(){var n,i=e.data(this,s);if(o==="instance")return f=i,!1;if(!i)return e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+t+" widget instance");n=i[o].apply(i,a);if(n!==i&&n!==r)return f=n&&n.jquery?f.pushStack(n.get()):n,!1}):(a.length&&(o=e.widget.extend.apply(null,[o].concat(a))),this.each(function(){var t=e.data(this,s);t?(t.option(o||{}),t._init&&t._init()):e.data(this,s,new i(o,this))})),f}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(n,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var t=this;this._destroy(),e.each(this.classesElementLookup,function(e,n){t._removeClass(n,e)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i=t,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof t=="string"){i={},s=t.split("."),t=s.shift();if(s.length){o=i[t]=e.widget.extend({},this.options[t]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];t=s.pop();if(arguments.length===1)return o[t]===r?null:o[t];o[t]=n}else{if(arguments.length===1)return this.options[t]===r?null:this.options[t];i[t]=n}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return e==="classes"&&this._setOptionClasses(t),this.options[e]=t,e==="disabled"&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var n,r,i;for(n in t){i=this.classesElementLookup[n];if(t[n]===this.options.classes[n]||!i||!i.length)continue;r=e(i.get()),this._removeClass(i,n),r.addClass(this._classes({element:r,keys:n,classes:t,add:!0}))}},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){function i(i,s){var o,u;for(u=0;u<i.length;u++)o=r.classesElementLookup[i[u]]||e(),t.add?o=e(e.unique(o.get().concat(t.element.get()))):o=e(o.not(t.element).get()),r.classesElementLookup[i[u]]=o,n.push(i[u]),s&&t.classes[i[u]]&&n.push(t.classes[i[u]])}var n=[],r=this;return t=e.extend({element:this.element,classes:this.options.classes||{}},t),this._on(t.element,{remove:"_untrackClassesElement"}),t.keys&&i(t.keys.match(/\S+/g)||[],!0),t.extra&&i(t.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(t){var n=this;e.each(n.classesElementLookup,function(r,i){e.inArray(t.target,i)!==-1&&(n.classesElementLookup[r]=e(i.not(t.target).get()))})},_removeClass:function(e,t,n){return this._toggleClass(e,t,n,!1)},_addClass:function(e,t,n){return this._toggleClass(e,t,n,!0)},_toggleClass:function(e,t,n,r){r=typeof r=="boolean"?r:n;var i=typeof e=="string"||e===null,s={extra:i?t:n,keys:i?e:t,element:i?this.element:e,add:r};return s.element.toggleClass(this._classes(s),r),this},_on:function(t,n,r){var i,s=this;typeof t!="boolean"&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){if(!t&&(s.options.disabled===!0||e(this).hasClass("ui-state-disabled")))return;return(typeof o=="string"?s[o]:o).apply(s,arguments)}typeof o!="string"&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var a=r.match(/^([\w:-]*)\s*(.*)$/),f=a[1]+s.eventNamespace,l=a[2];l?i.on(f,l,u):n.on(f,u)})},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(n).off(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.widget}),function(t){typeof define=="function"&&define.amd?define("widget",["jquery","./ns","jquery-ui/widget","./data"],t):t(e)}(function(e){return e.mobile.widget=e.mobile.widget||{}}),function(t){typeof define=="function"&&define.amd?define("widgets/widget.backcompat",["jquery","../ns","../widget","jquery-ui/widget"],t):t(e)}(function(e){if(e.mobileBackcompat!==!1){var t=/\S+/g;e.mobile.widget=e.extend({},{backcompat:{_boolOptions:{inline:"ui-button-inline",mini:"ui-mini",shadow:"ui-shadow",corners:"ui-corner-all"},_create:function(){this._setInitialOptions(),this._super(),!this.options.enhanced&&this.options.wrapperClass&&this._addClass(this.widget(),null,this.options.wrapperClass)},_classesToOption:function(n){if(this.classProp&&typeof n[this.classProp]=="string"){var i=this,s=n[this.classProp].match(t)||[];e.each(this._boolOptions,function(t,n){i.options[t]!==r&&(e.inArray(n,s)!==-1?i.options[t]=!0:i.options[t]=!1)})}},_getClassValue:function(n,r,i){var s=this.options.classes[n]||"",o=s.match(t)||[];return i?e.inArray(r,o)===-1&&o.push(r):o.splice(e.inArray(r,o),1),o.join(" ")},_optionsToClasses:function(e,t){var n=this.classProp,r=this._boolOptions[e];n&&this.option("classes."+n,this._getClassValue(n,r,t))},_setInitialOptions:function(){var n,i=this.options,s=e[this.namespace][this.widgetName].prototype.options,o=this.classProp,u=this;o&&(n=(i.classes[o]||"").match(t)||[],s.classes[o]!==i.classes[o]?e.each(this._boolOptions,function(t,s){i[t]!==r&&(i[t]=e.inArray(s,n)!==-1)}):e.each(this._boolOptions,function(e,t){i[e]!==s[e]&&(i.classes[o]=u._getClassValue(o,t,i[e]))}))},_setOption:function(e,t){var n;e==="classes"&&this._classesToOption(t),this._boolOptions[e]&&this._optionsToClasses(e,t),e==="wrapperClass"&&(n=this.widget(),this._removeClass(n,null,this.options.wrapperClass)._addClass(n,null,t)),this._superApply(arguments)}}},e.mobile.widget)}else e.mobile.widget.backcompat={};return e.mobile.widget})});
var W=typeof W!=="undefined"?W:{};var workpadEntries={};var usePf5=false;var bookletLazyLoad=null;var bookletScales=[.25,.33,.5,.67,1,2,3,4,5];var bodyOverflow=null;var $global={wpKey:null,featured:false,login:{},password:null,resizeRatio:false,autoplayId:0,resultMoved:null,edit:false,design:false,narrate:false,print:false,embed:false,mobile:false,publish:false,preview:false,share:false,bookletScale:1,backgroundImages:[],readOnly:false,adCount:0,lastAdPage:null,bookletWheelPanned:false,googleAnalyticsInitialized:false,analyticsPreviousPage:-1,databaseAnalyticsPreviousPage:-1,videoEndCreditPage:99999,pageAudio:null,flipping:false,leadGateOpened:false,render:true};var gridDiv;var rdpDiv;var post_load_modal_queue=[];var post_login_modal_queue=[];var openLeadWebsiteAction=function(){openLeadWebsite($(this).data("lightbox_click_url")||workpadEntries[$(this).data("id")].data,$(this).data("lead_click_action"))};var leadTypeActions={LEAD_EMAIL:"button-addemailresult",LEAD_PHONE:"button-addphoneresult",LEAD_SHARE:"public-vertical-card-share",LEAD_CAPTION:"button-addcaptionresult",LEAD_VIDEO:"lightbox_url",LEAD_MAP:"lightbox_url",LEAD_GOOGLE_FORM:"lightbox_url",BUTTON_GOOGLE_SPREADSHEET:"lightbox_url",BUTTON_GOOGLE_PRESENTATION:"lightbox_url",BUTTON_BUY:"lightbox_url",LEAD_IMAGE:"button-addimageresult",EMPTY_LINK_IMAGE:"button-addimageresult",EMPTY_LINK_DOC:"lightbox_url",EMPTY_LINK_CODE:"lightbox_url",LEAD_FIND:openGoogleMapByAddressId,LEAD_BUY:openLeadWebsiteAction,LEAD_WEBSITE:openLeadWebsiteAction,LEAD_RESERVE:openLeadWebsiteAction};function initRdp(account,wpKey){wpKey=wpKey?wpKey:parseQueryString("wpKey");if(!wpKey)console.log("rdp.js: no wpKey");usePf5=$("body").hasClass("pf5");if(IOS&&!IOS_SERVER){window.location.search+="&ios=1&referer="+encodeURI(document.referrer);if(DEV)console.log("added IOS to url");return}if(MOBILE){setInterval(function(){$("body").toggleClass("zoomed",isZoom())},200)}if(inIframe()){$("body").addClass("in-iframe")}$global.login.account_id=account?parseInt(account["account_id"]):0;$global.login.accountType=account?parseInt(account["plus"]):0;var lazyLoadVersion=!("IntersectionObserver"in window)?"8.7.1":"12.0.0";var lazyLoadUrl="/js/lazyload."+lazyLoadVersion+".min.js";$.getScript(lazyLoadUrl,function(){bookletLazyLoad=new LazyLoad({threshold:1e3})});if(!document.getElementById("bookletDiv")){$("<div id='bookletDiv' />").appendTo(document.body);if($global.embed){$("#bookletDiv").addClass("embed")}}if(usePf5&&parseQueryString("page")===""){setUrlPageNumber(1)}rdpDiv=createRdp();gridDiv=createGrid(rdpDiv);$global.bookletDiv=$("#bookletDiv");$global.bookletDiv.data("defaultWidth",$global.bookletDiv.width());$global.bookletDiv.data("defaultHeight",$global.bookletDiv.height());$global.rdpDiv=$("#rdpDiv");$global.gridDiv=$("#gridDiv");initBooklet();loadWorkpad(wpKey,initRdpLoadWorkpadComplete);if($global.embed){$(document).on("click","body.embed .pf a",function(){var href=$(this).attr("href");if(href&&href.indexOf("mailto")!==0){window.open(href,"_blank");return false}})}if(embed()&&!usePf5){$("#bookletDiv").get(0).addEventListener("wheel",bookletWheelPan)}}function initRdpLoadWorkpadComplete(){var popupId=parseQueryString("pid",true)||(parseQueryString("pid")==="public-vertical-card-install"?"public-vertical-card-install":"");var initialPage=getPageParam();bookletSetPages();lazyLoadUpdate();if(initialPage>$global.lastPage){initialPage=$global.lastPage}if(initialPage===0&&isGatefoldSingle()){initialPage=1}if(isRightToLeft()){initialPage=usePf5?0:$global.lastPage}if(editMode()||!isTurnJs()){changePage(initialPage,null,null,true)}else if(usePf5){gotoPage(initialPage)}if(editMode()){showCanvaEditTool()}$global.currentPage=initialPage;if(popupId){displayInitialModal(popupId)}setBusinessCardDownloadButton();changePageComplete();$(document).trigger("rdp-loaded");if(publicMode()){setTimeout(function(){$.ajax({url:"https://"+BASE_DOMAIN+"/workpad/workpad_public/log_workpad_view",data:{workpad_key:W["workpad_key"],workpad_view_log_data:workpadViewLogData},type:"POST",xhrFields:{withCredentials:true}})},750)}document.documentElement.style.setProperty("--page-width",W["width"]+"px")}function initBooklet(){createPageturnButtons();$(document).keyup(function(e){if($global.resultMoved){$global.resultMoved.savePosition();$global.resultMoved=null}else if($global.publish){var elementType=document.activeElement&&document.activeElement.nodeName?document.activeElement.nodeName.toLowerCase():"";if(elementType==="input"||elementType==="textarea"){return true}if(!isPaywallOpen()&&!isLeadgateOpen()){if(e.which===KEYCODES.ARROW_LEFT){changePage(-1)}else if(e.which===KEYCODES.ARROW_RIGHT){changePage(1)}}return false}});$global.currentPage=getPageParam();if(HANDHELD){$global.bookletDiv.rdpHandheld()}$(document).on("input","input.page_slider",function(){var page=$(this).val();gotoPage(page)});$global.bookletDiv.on("transitionend",function(){if(isFirefox()){if(document.body.scrollHeight>document.body.clientHeight){$("body").css("overflow-y","visible")}else{$("body").css("overflow-y","hidden")}}})}function rdpReset(){W={};workpadEntries={};$("#clickToAddMessageDiv").appendTo($(rdpDiv)).hide();$global.gridDiv.remove();gridDiv=createGrid(rdpDiv);$global.gridDiv=$(gridDiv);$global.currentPage=0;autoplayStop();$("#textResultsDiv").children().remove();$("body").css("backgroundImage","none").css("backgroundColor","none")}function loadWorkpad(wpKey,callback){rdpReset();$.ajax({url:"/workpad/workpad_public/get",data:{workpad_key:wpKey},success:function(response){$global.wpKey=wpKey;setWorkpadData(response.data);var pageRange="0-"+(isTrifold()?"6":isGatefold()?"8":LAZYLOAD_PAGE_THRESHOLD);if(isPwa()){pageRange="0-"+(isTrifold()?"6":isGatefold()?"8":$global.lastPage)}if($global.render){getWorkpadEntries(W["key"],pageRange,function(){loadWorkpadGetWorkpadEntriesComplete(response,callback)})}if(publicMode()&&W["email_on_open"]){if(DEV)console.log("requesting email notification");$.get("/workpad/workpad_public/email_notification",{workpad_key:wpKey})}if(W["slack_notification_toggle"]&&!parseQueryString("from-slack")){if(DEV)console.log("requesting slack notification");$.get("/workpad/workpad_public/slack_notification",{workpad_key:wpKey})}}})}function loadWorkpadGetWorkpadEntriesComplete(response,callback){paywallPrompt(W["id"]);leadGatePrompt();$("iframe.resultImg.iframe").on("load",function(){$(this).contents().find("body").css("margin","0")});updateResultDivAsync();analyticsTrackPage($global.currentPage);typeof getWorkpadNarrations==="function"&&getWorkpadNarrations();if(isRightToLeft()){gotoPage($global.lastPage,true)}if(typeof callback==="function"){callback(response)}}function updateResultDivAsync(){$(".resultDiv.async").each(function(){$(this).removeClass("async");getWorkpadEntry($(this).data("id"))})}function createRdp(){var $div=$("<div id='rdpDiv'></div>").addClass("book").appendTo("#bookletDiv");return $div.get(0)}function createGrid(parent){var $div=$("<div id='gridDiv'></div>").addClass("book").appendTo(parent);return $div.get(0)}function setWorkpadData(workpad){if(!workpad){return}W=workpad;W["id"]=W["workpad_id"];W["key"]=W["workpad_key"];if($global.publish&&+W["adult"]===1){if(!confirm("This booklet contains content that may be inappropriate for some users.")){return}}W["styles"]=resultParseFormat(W["format"]);if(editMode()){W["styles"].animation="swing"}else if(MOBILE){if(W["styles"].animation_mobile){W["styles"].animation=W["styles"].animation_mobile}else if(isTrifold()){W["styles"].animation="cardflip-trifold"}else if(!isCardflip()&&W["styles"].animation!=="swing"){W["styles"].animation="cardflip-single";W["styles"].effect=""}}$global.bookletDiv.visible();setBookletPosition();if(HANDHELD&&!usePf5){setTimeout(function(){window.scrollTo(0,1)},0)}var editPage=getPageParam();var lastPage=editMode()?Math.max(W["last_page"],editPage):W["last_page"];createPages(lastPage);gridStylesCss();bookletSetPages();showSticky();setAccountFeatures();gridStylesCssAnimations();scaleBookletToDevice();if(editMode()){setWorkpadDataEditMode()}else{if($global.bookletDiv.hasClass("ui-resizable")){$global.bookletDiv.resizable("destroy")}}setTheme(W["theme"]);if(W["page_audio_url"]){addPageAudio(W["page_audio_url"])}}function getResultDivIdPrefix(){return usePf5?PF5_PREFIX:""}function loadPages(pageList,reload){var pagesToLoad="";pageList.map(function(pageNumber){var $page=$(".pageDiv.page-"+pageNumber);if(!$page.hasClass("loaded")||reload){pagesToLoad+=(pagesToLoad?",":"")+pageNumber}});return pagesToLoad?getWorkpadEntries(W["key"],pagesToLoad):$.when()}function getWorkpadEntries(workpadKey,pages,callback){if(!workpadKey){console.log("getWorkpadEntries no workpadKey: pages=",pages);if(DEVELOPER_IP)console.trace();return}var idPrefix=getResultDivIdPrefix();return $.ajax({url:"/workpad/workpad_public/get_workpad_entries",data:{workpad_key:workpadKey,id_prefix:idPrefix,edit_mode:editMode(),pages:pages,pwa:isPwa(),sticky:pages&&!editMode()},type:"POST",success:function(json){if(json.status!=="ok"){return false}imagesToLoad=json.data.img_count;if(imagesToLoad===0){imgLoadedComplete()}for(var i in json.data.workpad_entries){addWorkpadEntryHtmlToPage(json.data.workpad_entries[i])}if(typeof callback==="function"){callback()}}})}function getWorkpadEntry(id,callback){if(!id){id=$(this).find("id").text()}var idPrefix=getResultDivIdPrefix();if(typeof id==="undefined"){return}return $.ajax({url:"/workpadentry/workpadentry_public/get_html",data:{workpad_key:W["key"],workpad_entry_id:id,id_prefix:idPrefix,edit_mode:editMode()},success:function(json){if(json.status!=="ok"){return false}addWorkpadEntryHtmlToPage(json.data,true,callback)}})}function addWorkpadEntryHtmlToPage(workpadEntry,injectPf5,callback){if(typeof workpadEntry.html==="undefined"||!workpadEntry.html){return false}var id=workpadEntry.workpad_entry_id;if(!id){return false}var resultIdSelector="#"+getResultDivIdPrefix()+"resultDiv_"+id;var page=isRightToLeft()?$global.lastPage-workpadEntry.page:workpadEntry.page;var $pageDiv=createPage(page,true);if(+workpadEntry.sticky&&$(resultIdSelector).length){return false}$(resultIdSelector).remove();$pageDiv.append(workpadEntry.html);if(!+workpadEntry["sticky"]){$pageDiv.addClass("loaded")}var $resultDiv=$(resultIdSelector);if($resultDiv.hasClass("for-nav")){if($resultDiv.hasClass("type-LEAD_EMAIL")){$(".state-chrome-messaging").empty();$(workpadEntry.html).appendTo(".state-chrome-messaging")}}if(editMode()){workpadEntryEditMode($resultDiv)}workpadEntries[id]=workpadEntry;$(".textResultDiv_"+workpadEntry.page+" .tocPagePreview").workpadEntryPreview($resultDiv);var resultDivSelector="#resultDiv_"+id;if(usePf5&&injectPf5){if(DEV)console.log("pf5 resultDiv: ",id,$(resultDivSelector,"#pageflip").length);$(resultDivSelector,"#pageflip").html($(workpadEntry.html).html());lazyLoadUpdate()}if($resultDiv.data("contentType")==="FORMBUILDER"){formBuilderRenderResultDiv($(resultDivSelector))}if(!editMode()&&hasAnimate()){animateWorkpadEntryAddEvents()}addRecaptchaForForms();if(typeof callback==="function"){callback()}}function addResultToPage($resultDiv,$pageDiv){$pageDiv.append($resultDiv)}function setDesign(){$global.design=true}function setEmbed(){$global.embed=true}function setMobile(){$global.mobile=true}function setPublish(){$global.publish=true}function setEdit(){$global.edit=true}function setNarrate(){$global.narrate=true}function setPreview(){$global.preview=true}function setShare(){$global.share=true}function setReadOnly(readOnly){$global.readOnly=Boolean(parseInt(readOnly))}function imageMode(){return $("body").hasClass("image")}function editMode(){return $global.edit&&!readOnly()}function designMode(){return $global.design}function narrateMode(){return $global.narrate}function previewMode(){return $global.preview}function readOnly(){return $global.readOnly}function shareMode(){return $global.share}function authorMode(){return editMode()||designMode()||narrateMode()||previewMode()||shareMode()}function publicMode(){return!previewMode()&&($global.publish||$global.embed)}function displayPublish(){window.open(rdpGetUrl({view:"publish"}),"_blank")}function displayPrint(){window.open(rdpGetUrl({view:"print"}),"_blank")}$.fn.extend({workpadEntryPreview:function($result){var $pagePreview=$(this);if(!$pagePreview.length){return}var x=$result.position().left||$result.data("x");var y=$result.position().top||$result.data("y");var $clone=$result.clone(false);$clone.removeAttr("id").removeClass("raised").removeClass("clicked").children(".resultOverlay").remove().children(".resultUnderlay").remove().css("left",x+"px").css("top",y+"px").visible().addClass("resultPreview").find("embed").remove();$pagePreview.append($clone)},workpadPagePreview:function($container,forSearch){var $page=$(this);var pageWidth=$page.width();var pageHeight=$page.height();var containerWidth=$container.width();var containerHeight=$container.height();if(containerHeight===0&&pageHeight===0){return}var pageNum=$page.attr("page");var $pagePreview=$("<div class='tocPagePreview_"+pageNum+" tocPagePreview' />");if(!$pagePreview.length){if(DEV)console.log("no page preview for pageNum: ",pageNum);return}var scale=containerWidth/containerHeight<pageWidth/pageHeight?containerWidth/pageWidth:containerHeight/pageHeight;var left=-Math.floor(pageWidth*(1-scale)/2);var top=-Math.floor(pageHeight*(1-scale)/2);$pagePreview.attr("page",pageNum).width(pageWidth).height(pageHeight).css("left",left+"px").css("top",top+"px").css("margin-left",forSearch?0:Math.floor((containerWidth-pageWidth*scale)/2)+"px").css("margin-top",Math.floor((containerHeight-pageHeight*scale)/2)+"px").css("transform","scale("+scale+")").css("background-image",$page.css("background-image")).css("background-repeat",$page.css("background-repeat")).css("background-position",$page.css("background-position")).css("background-size",$page.css("background-size"));if($page.css("background")){$pagePreview.css("background",$page.css("background"))}if($page.css("background-color")){$pagePreview.css("background-color",$page.css("background-color"))}$container.append($pagePreview);$(".resultDiv",$page).each(function(){$pagePreview.workpadEntryPreview($(this))})}});function bookletSetPages(){if(hasAnimate()){hideAnimatingIn($global.currentPage)}var $bookletDiv=$global.bookletDiv;$bookletDiv.find(".pageDiv,.pf-page-container").each(function(i){var $pageDiv=$(this);var width=+W["width"];var height=W["height"];var offset=isWall()?wallOffset():0;var y=i*(width+offset);$pageDiv.width(width).height(height);if(!$pageDiv.hasClass("turnjs")&&!$pageDiv.hasClass("pf-page-container")){if(!isCardflip()){$pageDiv.css("left",y+"px").data("y",y)}}if(isCardflip()){if($pageDiv.find(".card-flip-overlay").length===0){$pageDiv.addClass("card-flip").wrapInner('<div class="card-flip-overlay" />')}}});if(isCardflip()){$(".pageDiv *").each(function(){$(this).css("visibility","inherit")})}bookletSetFirstLastPage();createThumbnails()}function createThumbnails(){var $bookletDiv=$global.bookletDiv;var $tocDiv=$("#textResultsDiv");if($tocDiv.length){$bookletDiv.find(".pageDiv").each(function(i){var $page=$(this);var $textResultDiv=$(".textResultDiv_"+i);if(!$textResultDiv.length){$textResultDiv=$("<div class='textResultDiv_"+i+" textResult item' />").appendTo($tocDiv);var $previewContainer=$("<div class='tocPagePreviewContainer' />").appendTo($textResultDiv);$("<span class='textResultLabel'>"+(i+1)+"</span>").appendTo($textResultDiv);$page.workpadPagePreview($previewContainer);$textResultDiv.click(function(){var pageNum=$(this).index();$(this).addClass("selected").siblings().removeClass("selected");if(!$global.flipping){gotoPage(pageNum,true)}})}});if(editMode()){$tocDiv.sortable({update:tocPageSwap,scroll:true,helper:"original"})}}}function showAdOverlay(page){if(W["tier"]!=="free"||$global.adCount||!publicMode()){return}if($("#workpad-ad-overlay").is(":visible")){return}if(isRightToLeft()&&page!==0||page!==$global.lastPage){return}modalOpen("workpad-ad-overlay",{},function(){$global.adCount++;var adTimer=setInterval(function(){var $adClose=$(".ad-close");var countdown=$adClose.data("countdown")||AD_TIMER;if(countdown-- >1){$adClose.data("countdown",countdown);$adClose.html("Continue in "+countdown+"...")}else{clearInterval(adTimer);var closeHtml="Continue";$adClose.html(closeHtml).addClass("closeable").click(function(){modalCloseAnimate.call($("#workpad-ad-overlay").get(0))})}},1e3)})}function bookletSetFirstLastPage(){$global.firstPage=0;var pageDivs=$(".pageDiv").length;$global.lastPage=isTrifold()||isGatefold()?3:pageDivs?pageDivs-1:0;setCurrentPage();togglePageCorners()}function gotoPage(page,smooth){if(editMode()){slideOutToolsClose()}if(narrateMode()){modalClose()}if(page>$global.lastPage){page=$global.lastPage}var currentPage=+$global.currentPage;if(!usePf5){page=parseInt(page);if(isTrifold()||isGatefold()){(function trifoldFlips(){var currentPage=+$global.currentPage;if(page!==currentPage){var delta=(page-currentPage)/Math.abs(page-currentPage);changePage(delta);setTimeout(trifoldFlips,1e3)}})();return}if(isPageSpread()&&isCardflip()){page=isOdd(page)&&page<$global.lastPage?page+1:page;(function doubleBoardFlips(){var currentPage=+$global.currentPage;console.log("doubleBoardFlips: page,currentPage: ",page,currentPage);if(page!==currentPage){var delta=(page-currentPage)/Math.abs(page-currentPage);changePage(delta);setTimeout(doubleBoardFlips,333)}})();return}if(smooth){return changePage(page-currentPage)}else{var left=-page*W["width"];$global.gridDiv.css("left",left+"px")}}else{if(typeof pageflip!=="undefined"&&typeof pageflip.gotoPage==="function"){pageflip.gotoPageNumber(page+1,true)}}$global.currentPage=page;locationSetPage($global.currentPage);showSticky()}$(document).on("change keyup",".action-page-goto",function(e){var $target=$(e.target);if(e.type==="keyup"&&$target.is("input")){var keyCode=e.keyCode||e.which;if(keyCode!==13){return}}if(!$.isNumeric($(this).val()))return false;var page=$(this).val()-1;if(page>$global.lastPage)page=$global.lastPage;if(page<$global.firstPage)page=0;gotoPage(page,true)});function changePage(numPages,scrollTime,completeFunc,skipChangePageBefore){if(narrateMode()&&$("body").hasClass("action-recording")){return}if(typeof pauseNarratePosition==="function"){pauseNarratePosition()}modalClose("notes");if(editMode()){slideOutToolsClose()}else if(!skipChangePageBefore){if(changePageBefore(function(){changePage(numPages,scrollTime,completeFunc,true)})){return false}}if(narrateMode()&&!$("#welcome-narrate").is(":visible")){if(!$("#narration").length){if(DEV)console.log("Hidding modal on page flip");modalClose()}}bookletWheelPanReset();var currentPage=parseInt($global.currentPage);if(isPageSpread()&&!editMode()){if(numPages===1&&isEven(currentPage)&&currentPage<$global.lastPage-1){numPages++}else if(numPages===-1&&isEven(currentPage)){numPages--}}numPages=currentPage+numPages<$global.firstPage?$global.firstPage-currentPage:numPages;if(!numPages){return false}var dist=numPages*W["width"];var newCurrentPage=currentPage+numPages;if(hasAnimate()){hideAnimatingIn(newCurrentPage)}if(hasVideos()){stopVideosOnChangePage(currentPage,newCurrentPage)}if(editMode()){editChangePage(newCurrentPage,dist)}else if(usePf5){pf5ChangePage(newCurrentPage)}else if(newCurrentPage>=$global.firstPage&&newCurrentPage<=$global.lastPage){$global.currentPage=newCurrentPage-$global.firstPage;if(scrollTime){$global.gridDiv.animate({left:"-="+dist+"px"},{easing:"linear",duration:scrollTime*1e3,complete:completeFunc})}else{var random_animations=["swing","easeInOutBack","easeInBack","easeInCubic","fadeoutin"];var styles=W["styles"];var animation=styles&&styles.animation?styles.animation:"swing";var duration=styles&&styles.flip_duration?styles.flip_duration:500;var delay=0;var forward=numPages>0;var newPageDivIndex=isPageSpread()&&forward&&(!isLastPage()||isEven($global.lastPage))?Math.max($global.currentPage-1,0):$global.currentPage;var curPageDivIndex=isPageSpread()&&!forward?Math.min($global.currentPage+1,$global.lastPage):currentPage;var $pageDivs=$(".pageDiv");var $curPageDiv=$($pageDivs.get(curPageDivIndex));var $newPageDiv=$($pageDivs.get(newPageDivIndex));if(animation==="random"){animation=random_animations[Math.floor(Math.random()*random_animations.length)]}if(animation==="instant"){$curPageDiv.data("background_bak",$curPageDiv.css("background")).data("background-image_bak",$curPageDiv.css("background-image")||"none").data("background-repeat_bak",$curPageDiv.css("background-repeat")).data("background-position_bak",$curPageDiv.css("background-position")).data("background-size_bak",$curPageDiv.css("background-size")).css("background","transparent").css("background-image","none").css("z-index",1);$newPageDiv.css("left",$curPageDiv.css("left")).hide().fadeIn(styles.effect?duration+delay:0);$(".resultDiv",$curPageDiv).promise().done(function(){$global.gridDiv.css("left",parseInt($global.gridDiv.css("left"))-dist+"px");$curPageDiv.css("z-index",0).css("background",$curPageDiv.data("background_bak")).css("background-image",$curPageDiv.data("background-image_bak")).css("background-repeat",$curPageDiv.data("background-repeat_bak")).css("background-position",$curPageDiv.data("background-position_bak")).css("background-size",$curPageDiv.data("background-size_bak"));$newPageDiv.css("left",$newPageDiv.data("y"));changePageComplete($curPageDiv)})}else if(animation==="easeInOutBack"){$global.gridDiv.delay(delay).animate({left:"-="+dist+"px"},duration,"easeInOutBack")}else if(animation==="easeInBack"){$global.gridDiv.delay(delay).animate({left:"-="+dist+"px"},duration,"easeInBack")}else if(animation==="easeInCubic"){$global.gridDiv.delay(delay).animate({left:"-="+dist+"px"},duration,"easeInCubic")}else if(animation.indexOf("fadeoutin")>=0){var default_color=styles.animation==="random"?Math.random()*2>1?"white":"black":"white";var background=animation.substring(animation.indexOf("fadeoutin")+10)||default_color;$("#bookletDiv").css("background",background);$global.gridDiv.delay(delay).animate({opacity:0},duration,"swing",function(){$(this).css("left",parseInt($(this).css("left"))-dist+"px").animate({opacity:1},duration,"swing")})}else if(isWall()){dist=numPages*(+W["width"]+wallOffset());var finalDist=parseInt($global.gridDiv.css("left"))-dist;$(".pagecorner").addClass("disable");$global.gridDiv.off("transitionend").on("transitionend",function(){$(".pagecorner").removeClass("disable")}).css("left",finalDist+"px")}else if(isCardflip()){doCardFlip($curPageDiv,$newPageDiv,forward,animation)}else{$global.gridDiv.delay(delay).animate({left:"-="+dist+"px"},duration,"swing")}if(animation!=="instant"&&!isTurnJs()&&!isCardflip()){$global.gridDiv.find(".resultDiv").addBack().promise().done(function(){changePageComplete($curPageDiv)})}}setTimeout(function(){locationSetPage($global.currentPage)},isSafari&&animation==="cardflip-single"?50:0)}if($global.pageAudio){$global.pageAudio.currentTime=0;var promise=$global.pageAudio.play();promise.then(function(){}).catch(function(error){})}return true}function setFlipping(value){$global.flipping=Boolean(value);$("body").toggleClass("cardflip-flipping",$global.flipping)}function doCardFlip($oldPage,$newPage,forward){var $body=$("body");setFlipping(true);$global.bookletDiv.removeClass(function(index,className){return(className.match(/\bpage-\w+/g)||[]).join(" ")}).addClass("page-"+$global.currentPage+(isLastPage()?" page-last":"")+(!isShowingSinglePage()?" page-double":""));$(".pageDiv").removeClass("new-page old-page flip keep-visible visibility-hidden forward backward");var vertical=isCardflipVertical();var trifold=isTrifold();var cardFlipClass="card-flip "+(vertical?" vertical":"");var direction=forward?"forward":"backward";bodyOverflow=bodyOverflow||$body.css("overflow");if(document.body.scrollHeight<=document.body.clientHeight){$body.css("overflow","hidden")}var pages;if(isPageSpread()){setPageSpreadFlipPages($oldPage,forward)}else if(trifold){pages=setTrifoldFlipPages($oldPage,$newPage,forward);$oldPage=pages.oldPage;$newPage=pages.newPage}else if(isGatefold()){pages=setGatefoldFlipPages($oldPage,$newPage,forward);$oldPage=pages.oldPage;$newPage=pages.newPage}var singleFlip=$global.bookletDiv.hasClass("cardflip-single");if(!singleFlip||direction==="backward"){$newPage.addClass(cardFlipClass+" new-page visibility-hidden "+direction).off("transitionend").on("transitionend",function(){if($(this).hasClass("new-page")){$(".pageDiv,.fold-container").removeClass("flip new-page old-page keep-visible visibility-hidden "+direction);$(this).removeClass(direction);$body.css("overflow",bodyOverflow);$(".pagecorner").removeClass("disable");if((trifold||isGatefold())&&$global.currentPage===3&&!isTrifoldNoFoldBack()){$(".fold-container.pages-back").addClass("finish")}changePageComplete()}return false})}if(!singleFlip||direction==="forward"){$oldPage.removeClass("finish").addClass(cardFlipClass+" old-page "+direction).off("transitionend").on("transitionend",function(){if($(this).hasClass("old-page")){$(this).removeClass("flip old-page "+direction);if(trifold||isGatefold()){scaleBooklet(1)}}if(!singleFlip&&!$newPage.hasClass("flip")){$newPage.removeClass("visibility-hidden");$newPage.addClass("flip")}else if(singleFlip){$body.css("overflow",bodyOverflow);changePageComplete()}return false})}if(singleFlip&&direction==="backward"){$oldPage.addClass("old-page");setTimeout(function(){$newPage.removeClass("visibility-hidden").addClass("flip")},50)}else{$oldPage.addClass("flip")}}function setPageSpreadFlipPages($oldPage,forward){if($oldPage.attr("page")!=="0"){var $pageDivs=$(".pageDiv");var forwardKeepVisible=isLastPage()&&isOdd($global.lastPage)?2:3;if(forward&&$global.currentPage>forwardKeepVisible){$($pageDivs.get($global.currentPage-forwardKeepVisible)).addClass("keep-visible")}else if(!forward&&$global.currentPage<$global.lastPage-1){$($pageDivs.get($global.currentPage+2)).addClass("keep-visible")}}}function setTrifoldFlipPages($oldPage,$newPage,forward){$(".pagecorner").addClass("disable");$(".fold-container .pageDiv").sort(function(a,b){return+a.getAttribute("page")-+b.getAttribute("page")}).appendTo($global.gridDiv);if($global.currentPage===2){if(forward){$newPage=$(".pageDiv.page-3");$oldPage=$(".pageDiv.page-4")}else{$oldPage=$(".fold-container.pages-back");$("#pageDiv_4").appendTo($oldPage);$("#pageDiv_5").appendTo($oldPage);$("#pageDiv_0").appendTo($oldPage);$newPage=$(".fold-container.pages-front");$("#pageDiv_1").appendTo($newPage);$("#pageDiv_2").appendTo($newPage);$("#pageDiv_3").appendTo($newPage)}}else if($global.currentPage===1&&!forward){$newPage=$(".pageDiv.page-4");$oldPage=$(".pageDiv.page-3")}else if($global.currentPage===3){$oldPage=$(".fold-container.pages-front");$("#pageDiv_1").appendTo($oldPage);$("#pageDiv_2").appendTo($oldPage);$("#pageDiv_3").appendTo($oldPage);$newPage=$(".fold-container.pages-back");$("#pageDiv_4").appendTo($newPage);$("#pageDiv_5").appendTo($newPage);$("#pageDiv_0").appendTo($newPage)}$oldPage[0].offsetWidth;$newPage[0].offsetWidth;return{oldPage:$oldPage,newPage:$newPage}}function setGatefoldFlipPages($oldPage,$newPage,forward){$(".pagecorner").addClass("disable");$(".fold-container .pageDiv").sort(function(a,b){return+a.getAttribute("page")-+b.getAttribute("page")}).appendTo($global.gridDiv);if($global.currentPage===0){if(!forward){$oldPage=$("#pageDiv_1");$newPage=$("#pageDiv_0")}}if($global.currentPage===1){if(!forward){var $container=$(".fold-container.pages-front");$("#pageDiv_4").appendTo($container);$("#pageDiv_5").appendTo($container);$oldPage=$(".pageDiv.page-3, .pageDiv.page-6");$newPage=$(".pageDiv.page-1, .pageDiv.page-2")}}else if($global.currentPage===2){if(forward){$oldPage=$(".pageDiv.page-1, .pageDiv.page-2");$newPage=$(".pageDiv.page-3, .pageDiv.page-6")}else{$oldPage=$(".fold-container.pages-back");$("#pageDiv_2").appendTo($oldPage);$("#pageDiv_7").appendTo($oldPage);$("#pageDiv_0").appendTo($oldPage);$("#pageDiv_1").appendTo($oldPage);$newPage=$(".fold-container.pages-front");$("#pageDiv_3").appendTo($newPage);$("#pageDiv_4").appendTo($newPage);$("#pageDiv_5").appendTo($newPage);$("#pageDiv_6").appendTo($newPage)}}else if($global.currentPage===3){$oldPage=$(".fold-container.pages-front");$("#pageDiv_3").appendTo($oldPage);$("#pageDiv_4").appendTo($oldPage);$("#pageDiv_5").appendTo($oldPage);$("#pageDiv_6").appendTo($oldPage);$newPage=$(".fold-container.pages-back");$("#pageDiv_2").appendTo($newPage);$("#pageDiv_7").appendTo($newPage);$("#pageDiv_0").appendTo($newPage);$("#pageDiv_1").appendTo($newPage)}$oldPage[0].offsetWidth;$newPage[0].offsetWidth;return{oldPage:$oldPage,newPage:$newPage}}function changePageBefore(changePageFunction){if(hasAnimate()){if($(".resultDiv.page-"+$global.currentPage+".animate__infinite").length){return false}$(".resultDiv.animated-out").removeClass("animated-out");animateWorkpadEntries($global.currentPage,"close").then(changePageFunction);return true}if(narrateMode()){narrationChangePageSaveCheck(changePageFunction)}return false}function changePageComplete(){showSticky();if(parseInt(W["link_flash"])){linkFlash($global.currentPage);if(isPageSpread()&&$global.currentPage>0){linkFlash($global.currentPage-1)}}if(hasAnimate()){animateWorkpadEntries($global.currentPage,"open")}setFlipping(false);if(hasVideos()){manageStartPageVideos($global.currentPage)}else{}$("a.l").each(function(){if($(this).attr("href").indexOf("#")!==0&&$(this).attr("target")!=="_blank"){$(this).attr("target","_blank")}});typeof togglePageNarration==="function"&&togglePageNarration();if(narrateMode()){narrationModalLoadTeleprompt();narrationModalLoadAudio();narrationModalLoadVideo()}$(document).trigger("change-page-complete")}function showSticky(){if(usePf5){return}$("div.resultDiv.sticky","#bookletDiv").each(function(){var $resultDiv=$(this);var $pageDiv=pageContainer($global.currentPage);if(!editMode()||$pageDiv.find(".resultDiv").length){addResultToPage($resultDiv,$pageDiv)}if($resultDiv.data("clickurl")&&!editMode())addResultClick($resultDiv)})}function pageContainer(page){return usePf5?$("#page"+(+page+1)):pageDiv(page)}function pageDiv(page){return $("#pageDiv_"+page)}function addResultClick($resultDiv){var target="";if($resultDiv.data("clickurl").toLowerCase().indexOf("http")===0){target="target='"+($resultDiv.data("target")?$resultDiv.data("target"):"_blank")+"'"}$resultDiv.wrap("<a href='"+$resultDiv.data("clickurl")+"' style='color: inherit; text-decoration: none;' "+target+"/>")}function autoplayStart(delay,scrollTime,repeat){if(!editMode()&&!$global.imageMode&&!shareMode()){if(scrollTime){gotoPage(0);var numPages=parseInt($global.lastPage-$global.currentPage);var completeFunc=repeat?function(){autoplayStart(delay,scrollTime,repeat)}:null;setTimeout(function(){changePage(numPages,scrollTime*numPages,completeFunc)},500)}else{var intervalDelay=parseInt(delay)*1e3;var autoplayElapsedTime=0;$global.autoplayId=setInterval(function(){var animated=$(":animated").length;if(animated)return;if($global.currentPage<$global.lastPage){changePage(1)}else{if(parseInt(repeat)){gotoPage(0)}else{autoplayStop()}}autoplayElapsedTime+=intervalDelay},intervalDelay)}}}function autoplayStop(){if($global.autoplayId)clearInterval($global.autoplayId)}function getPageParam(){return(+parseQueryString("page")||1)-1}function setUrlPageNumber(pageNumber,url){url=url?url:window.location.href;url=url.substr(0,url.indexOf("#"))||url;window.history.replaceState({page:0},"page",url+"#page="+pageNumber)}function locationSetPage(page){$global.currentPage=page<$global.lastPage?page>0?page:0:$global.lastPage;var currentPage=getCurrentPage(true);lazyLoadUpdate();setCurrentPage(getCurrentPage(false));paywallPrompt(W["id"]);leadGatePrompt();if($("body").hasClass("for-video")&&$global.currentPage>=$global.videoEndCreditPage){videoEndCredit()}showAdOverlay(currentPage);if(!embed()){setUrlPageNumber(+currentPage+1)}if(usePf5&&typeof pf5SetActiveContent==="function"){pf5SetActiveContent()}$("#page-range-slider").val(currentPage+1);if(editMode()){slideOutToolsClose();bookletDisplayClickToAddWatermark($global.currentPage);showCanvaEditTool()}if(narrateMode()){modalClose()}$("input.page_slider").val(currentPage);togglePageCorners();analyticsTrackPage(currentPage);loadNextPages(currentPage)}function loadNextPages(currentPage){var pages=[currentPage];if(currentPage<$global.lastPage){pages.push(currentPage+1)}if(currentPage>0){pages.push(currentPage-1)}var pageRequests=$.when();pages.forEach(function(nextPage){var $nextPageDiv=pageContainer(isRightToLeft()?$global.lastPage-nextPage:nextPage);if($nextPageDiv.hasClass("loaded")){return}pageRequests=pageRequests.then(function(){return getWorkpadEntries(W["key"],nextPage,function(){if(editMode()){bookletDisplayClickToAddWatermark($global.currentPage)}else{showSticky()}lazyLoadUpdate()})})})}function getCurrentPage(useRTL){var rtl=useRTL&&isRightToLeft();return rtl?$global.lastPage-$global.currentPage:$global.currentPage}function setCurrentPage(page){var pageValue=page||$global.currentPage;$(".pageDiv").removeClass("current facing");$("#pageDiv_"+pageValue).addClass("current");if(pageValue>0&&isEven(pageValue)&&isPageSpread()){$("#pageDiv_"+(pageValue-1)).addClass("facing")}}function togglePageCorners(){var pageDisplayNum=1+getCurrentPage(true);$(".currentPageNumber").text(pageDisplayNum).val(pageDisplayNum);$(".totalPageNumber").text(editMode()?$(".pageDiv").length:Number(W["last_page"])+1);if(isFirstPage())$(".pagecorner.prev").hidden();else $(".pagecorner.prev").visible();if(!editMode()&&isLastPage())$(".pagecorner.next").hidden();else $(".pagecorner.next").visible()}function firstPage(smooth){gotoPage(isGatefoldSingle()?1:isRightToLeft()&&!usePf5?$global.lastPage:0,smooth)}function lastPage(smooth){gotoPage($global.lastPage-$global.firstPage,smooth)}function resultParseFormat(format){var styles={};if(format){var fields=format.split("&");for(var i in fields){var field=fields[i].split("=");var name=field[0];var value=unescape(field[1]);if(name&&value){styles[name]=value}}}if(parseQueryString("animation")){styles["animation"]=parseQueryString("animation")}return styles}function gridStylesCss(styles,ignoreBodyImage){var $body=$("body");var $bookletDiv=$global.bookletDiv;styles=styles?styles:W["styles"];if(styles){if(styles.bodyColor){if(!$global.embed){$body.css("backgroundColor",styles.bodyColor||"")}else{$body.css("backgroundColor","transparent").css("background","transparent")}}if(styles.bodyImage&&!ignoreBodyImage){$body.css("backgroundImage",styles.bodyImage!=="none"&&!$global.embed?"url('"+styles.bodyImage+"')":"none");$body.css("background-position",styles.position!=="none"&&!$global.embed?styles.position:"0% 0%");$body.css("background-repeat",styles.repeat!=="none"&&!$global.embed?styles.repeat:"no-repeat");$body.css("background-attachment",styles.attachment!=="none"&&!$global.embed?styles.attachment:"none");$body.css("background-size",styles.size!=="none"&&!$global.embed?styles.size:"auto");if(styles.bodyImage!=="none"&&W["animate_background"]&&!(isSafari()||isFirefox())&&styles.size==="cover"&&styles.bodyImage.indexOf(".svg")<0){var img=new Image;img.src=styles.bodyImage;img.onload=function(){var imgRatio=this.height?this.width/this.height:1;var windowRatio=window.innerHeight?window.innerWidth/window.innerHeight:1;var scaleUp=imgRatio>windowRatio?imgRatio/windowRatio:1;var start=W["animate_background"]==="zoom-in"?100*scaleUp+"%":110*scaleUp+"%";var end=W["animate_background"]==="zoom-in"?110*scaleUp+"%":100*scaleUp+"%";$body.addClass("animate-background").css("background-size",start).css("background-position","center center");setTimeout(function(){$body.css("background-size",end)},200)}}}var backgroundImage=!styles.backgroundImage||styles.backgroundImage==="undefined"||styles.backgroundImage==="none"?"none":"url('"+styles.backgroundImage+"?"+(new Date).getTime()+"')";$(".pf-page-container , .pageDiv").css("background",styles.backgroundColor).css("background-color",styles.backgroundColor).css("background-image",backgroundImage);$("#bookletPagePrev").removeClass().addClass("pagecorner rdp-pagecorner prev ");$("#bookletPageNext").removeClass().addClass("pagecorner rdp-pagecorner next ");$bookletDiv.removeClass("rounded square").addClass("square");if(!editMode()){bookletDivAddClassAnimation(styles.animation)}$bookletDiv.attr("class",function(i,c){return c.replace(/border_\S+/g,"")});if(styles.booklet_border_style){$bookletDiv.addClass(styles.booklet_border_style);setPf5BorderShadow(hasBorderShadow())}}if(!usePf5){$bookletDiv.width(W["width"]).height(W["height"]);$bookletDiv.find(".resultDiv.type-BACKGROUND").each(function(){resultImageToBackground($(this))})}}function gridStylesCssAnimations(styles){styles=styles?styles:W["styles"];if(styles){if(styles.animation&&!editMode()){if(styles.animation==="autoscroll"){autoplayStart(styles.animationtiming,styles.animationtiming,styles.animationrepeat||0)}else if(styles.animation==="autoflip"||styles.pagecontrol==="autoflip"){autoplayStart(styles.animationtiming,0,styles.animationrepeat||0)}}}}function bookletDivAddClassAnimation(animation,oldAnimation){var cardFlip="cardflip-";var elements=$("body, #bookletDiv");if(oldAnimation){var classesToRemove=oldAnimation;if(oldAnimation.indexOf(cardFlip)>=0){classesToRemove+=" cardflip"}else if(oldAnimation.indexOf("wall_")>=0){classesToRemove+=" wall"}elements.removeClass(classesToRemove)}if(animation){var classesToAdd=animation;if(animation.indexOf(cardFlip)>=0){classesToAdd+=" cardflip";if(animation==="cardflip-gatefold-single"){classesToAdd+=" cardflip-gatefold"}else if(animation==="cardflip-trifold-nofold"){classesToAdd+=" cardflip-trifold"}}else if(animation.indexOf("wall_")>=0){classesToAdd+=" wall"}elements.addClass(classesToAdd)}if(isTrifold()||isGatefold()){if($global.currentPage===0&&!$global.bookletDiv.hasClass("page-0")){$global.bookletDiv.addClass("page-0")}if($(".fold-container").length===0){$("<div class='fold-container pages-front' ><div class='card-flip-overlay' /></div>").appendTo($global.gridDiv);$("<div class='fold-container pages-back' ><div class='card-flip-overlay' /></div>").appendTo($global.gridDiv)}}else if(isCardflip()){if(!IOS){$global.gridDiv.width(isPageSpread()?0:W["width"])}}if(animation==="cardflip-single-vertical"){elements.toggleClass("cardflip-single",true)}}function getEmbedUrl(gadget,nocache,source){var scriptName=gadget?"ig":"embed";source=typeof source==="string"?source:scriptName;return rdpGetUrl({view:scriptName,source:source,nocache:nocache,noprotocol:false})}function getEmbedCode(custom_width,nocache,source){var borderPadding=hasBorderShadow()?32:0;var width=borderPadding+parseInt(W["width"]);var height=borderPadding+parseInt(W["height"]);var style="border: 0; overflow: hidden;";if(custom_width==="container"){height="100%"}else{if(custom_width){var r=custom_width/width;width=Math.ceil(r*width);height=Math.ceil(r*height);if(isPageSpread()){height=parseInt(height/2)}}else{if(isPageSpread()){height=parseInt(height/2)}}style+=" width: 1px; min-width: 100%; max-width:"+width+"px;"}var url=getEmbedUrl(false,nocache,source);return"<iframe src='"+url+"' allowfullscreen width='100%' height='"+height+"' style='"+style+"' scrolling='no'></iframe>"}function getBookletImageUrl(gif){var url_base=get_image_url_base();return url_base+(gif?"/gifs/"+W["key"]+".gif":"/thumbs/w500/"+W["key"]+".jpg")}function bookletEmail(isPublic=true){loadRecaptchaV2(function(){jsLoad("/js/bookletemail.js",typeof bookletEmailCallback,function(){var modalId=isPublic?"public-vertical-card-email":"share-task-email-html";modalOpen(modalId,{public:+isPublic},bookletEmailCallback)})})}function whenRecaptchaReady(callback,maxAttempts=20,interval=100){if(typeof callback!=="function"){return}let attempts=0;const intervalId=setInterval(()=>{attempts++;if(window.grecaptcha&&window.grecaptcha.render){if(DEV)console.log("reCAPTCHA is ready. Calling callback. attempts: "+attempts);clearInterval(intervalId);callback()}else if(attempts>=maxAttempts){if(DEV)console.log("reCAPTCHA did not become ready in time. Max attempts reached.");clearInterval(intervalId)}else{if(DEV)console.log("reCAPTCHA not ready yet. Attempt "+attempts)}},interval)}function loadRecaptchaV2(callback){if(DEV)console.log("loading recaptcha v2. callback: "+typeof callback);jsLoad("https://www.google.com/recaptcha/api.js",typeof grecaptcha,function(){if(DEV)console.log("recaptcha api.js loaded. callback: "+typeof callback);whenRecaptchaReady(function(){if(DEV)console.log("recaptcha ready. callback: "+typeof callback);jsLoad("/js/recaptcha_v2_util.js",typeof initRecaptchaV2,callback)})})}$(document).ready(function(){$(document).on("click","#gifemail",function(){var checked=$(this).is(":checked");showLoading();$(this).closest(".modal").find(".action-booklet-email-image").one("load",function(){hideLoading()}).attr("src",getBookletImageUrl(checked))})});function rdpGetUrl(options){options=typeof options!=="object"?{}:options;var view=typeof options.view==="string"?options.view:"design";var file=view+".php";var domain=document.domain;var protocol="https:";var query_string="wpKey="+W["key"];if(typeof options.source==="string")query_string+="&source="+options.source;if(typeof options.nocache==="boolean")query_string+=options.nocache?"&t="+(new Date).getTime():"";if(typeof options.noprotocol==="boolean")protocol=options.noprotocol?"":protocol;if(typeof options.domain==="string")domain=options.domain;return protocol+"//"+domain+"/"+file+"?"+query_string}function getThumbUrl(){return location.protocol+"//"+document.domain+"/thumbs/"+W["key"]+".jpg"}$(document).on("click",".contactform_element",function(){if(editMode())return false});$(document).on("click",".contactWidgetEmailSend",function(){if(editMode())return false;var $this=$(this);var $result=$this.closest(".resultDiv");var $form=$this.closest("form").length?$this.closest("form"):$result;var from=$("input[name=from]",$form).val();var emailHtml="";$(".msg",$form).remove();if(!from){from=$("input[name=Email]",$form).val()||$("input[name=email]",$form).val()||$("input[name=From]",$form).val()||$("input[name=from]",$form).val()}if(!validateEmail.test(from)){$this.after('<div class="msg"  style="color: #fff; margin-top: 20px; padding: 5px; background: #f00; border-radius: 3px;">Please provide your email.</div>');return false}$(".contactform_element",$form).each(function(){var val=$(this).val().trim();if(val.length>1)emailHtml+=$(this).attr("name")+": "+val+"<br>\n"});if(emailHtml.length<=1){$this.after('<div class="msg"  style="color: #fff; margin-top: 20px; padding: 5px; background: #f00; border-radius: 3px;">Please add a message.</div>');return false}var data={from:from,message:emailHtml,workpad_entry_id:$result.data("id"),page:$global.currentPage};var sendButtonHtml=$this.html();var sendNode=$this;$this.html("<img src='/img/rolling-load.gif'>");sendWorkpadEntryFormEmail(null,data,function(){sendNode.html(sendButtonHtml);$this.after('<div class="msg" style="color: #222; margin-top: 20px; display: none; padding: 5px; background: #fff; border-radius: 3px; ">Email Sent!</div>');$this.closest("div").find("div.msg").fadeIn(1e3,function(){$(this).delay(3e3).fadeOut(1e3)});$form.find("input, textarea").val("")});return false});function sendWorkpadEntryFormEmail(button,data,callback){initRecaptchaForForms(function(){if(button){var $form=$(button).closest("form");var $from=$form.find("input[name=from]").length?$form.find("input[name=from]"):$form.find("input[name=email]");var $message=$form.find("textarea[name=message]");var from=$from.val();var message=$message.val();var workpad_entry_id=$form.find("input[name=workpad_entry_id]").val();if(!validateEmail.test(from)){return $from.addClass("validate_error")}else{$from.removeClass("validate_error")}if(!message){return $message.addClass("validate_error")}else{$message.removeClass("validate_error")}data={from:from,message:message,workpad_entry_id:workpad_entry_id,page:$global.currentPage}}data["recaptcha"]=$("input[name=workpad-form-recaptcha]").val();$.ajax({url:"/email/workpadentry_email/form_send",type:"POST",data:data,success:function(data){modalToast(data.message,modalClose);if(typeof callback==="function"){callback()}},error:function(data){modalToast(data.message)},complete:function(){initRecaptchaForForms()}})})}function addRecaptchaForForms(){var $body=$("body");if($body.find("#workpad-form-recaptcha").length){return}if($(".contactWidgetEmailSend,.type-LEAD_EMAIL").length){var $recaptchaContainer=$('<div id="workpad-form-recaptcha" />').appendTo($body);$body.append('<input type="hidden" name="workpad-form-recaptcha" />');loadRecaptchaV2(function(){if(DEV)console.log("recaptcha loaded");if(typeof renderRecaptchaToContainer==="function"){if(DEV)console.log("rendering recaptcha container");renderRecaptchaToContainer($recaptchaContainer.get(0))}})}}function initRecaptchaForForms(callback){if(DEV)console.log("initRecaptchaForForms");loadRecaptchaV2(function(){if(DEV)console.log("initRecaptchaForForms initRecaptchaV2");initRecaptchaV2("workpad_form","workpad-form-recaptcha",callback)})}function setAccountFeatures(){$(".requireOwner, .requirePro").each(function(){var $this=$(this);if($this.hasClass("requireOwner"))if(!readOnly())$this.addClass("hasOwner");else $this.removeClass("hasOwner");if($this.hasClass("requirePro")){if(isUpgraded()){$this.addClass("hasPro").addClass(readOnly()?"":"hasOwner")}else{$this.removeClass("hasPro").removeClass(readOnly()?"":"hasOwner")}}if(this.onclick&&!$this.data("onclick")){$this.data("onclick",this.onclick);this.onclick=function(event){if($this.hasClass("requireOwner")&&$this.hasClass("hasOwner")||$this.hasClass("requirePro")&&$this.hasClass("hasPro")&&$this.hasClass("hasOwner")){$this.data("onclick").call(this,event||window.event)}else if($this.hasClass("requirePro")&&!$this.hasClass("hasPro")&&loggedIn()){return modalToastConfirm("Upgrade to access this feature.",function(){modalClose();modalOpen("upgrade")})}}}})}function loggedIn(){return $global.login&&$global.login.account_id}$(document).on("click",'#bookletDiv a, .resultDiv[data-content-type^="EMPTY_LINK"], .click-bound',function(){var href=$(this).attr("href")||$(this).data("url")||$(this).data("lightbox_click_url");if(!href||typeof href==="undefined"){return}var matches=href.match(/^https?:\/\/([^\/?#]+)(?:[\/?#]|$)/i);var domain=matches&&matches[1];if(domain&&domain!==BASE_DOMAIN){googleAnalyticsTrackLink(href)}});function analyticsTrackPage(page){if(!W.id){return}var visiblePages=[page];if(!isShowingSinglePage()){visiblePages.push(isAlwaysOpened()?page+1:page-1)}if($global.analyticsPreviousPage===page){return}for(var i in visiblePages){var logPage=visiblePages[i];var gaPage=logPage+1;googleAnalyticsPageview(gaPage?googleAnalyticsTrackPrefix()+"page-"+gaPage:"");matomoTrackPage(window.location.pathname+"#page="+gaPage);databaseTrackPage(logPage,visiblePages)}$global.analyticsPreviousPage=page}function databaseTrackPage(page){if(!W[TRACK_PAGE_ANALYTICS]||authorMode()||imageMode()){return}if(!IS_NARRATE&&+W["log_page_view"]){setTimeout(logPageView,1e3,$global.currentPage,page)}}function logPageView(currentPage,logPage){if(currentPage!==$global.currentPage){return}$.ajax({url:"/workpad/workpad_event_log/page_view",data:{workpad_id:W.id,page:logPage},type:"POST"})}function googleAnalyticsIsUA(){var gaId=W["default_ga_id"];return gaId&&gaId.indexOf("U")===0&&typeof ga==="function"}function googleAnalyticsIsGA4(){var gaId=W["default_ga_id"];return gaId&&gaId.indexOf("G")===0&&typeof gtag==="function"}function googleAnalyticsTrackLink(url){if(googleAnalyticsCreate()){if(DEV)console.log("workpadTracker.send","event",googleAnalyticsTrackPrefix(),"link-click",url);googleAnalyticsEvent(googleAnalyticsTrackPrefix(),"link-click",url)}if(!authorMode()){logEvent("LINK_CLICK",null,url)}}function googleAnalyticsCreate(){if(loggedIn()){return false}if(!W||!W["default_ga_id"]){return false}if($global.googleAnalyticsInitialized){return true}if(googleAnalyticsIsGA4()){gtag("js",new Date);gtag("config",W["default_ga_id"]);$global.googleAnalyticsInitialized=true}else if(googleAnalyticsIsUA()){ga("create",W["default_ga_id"],"auto","workpadTracker");$global.googleAnalyticsInitialized=true}return $global.googleAnalyticsInitialized}function googleAnalyticsPageview(pageTitle){if(!googleAnalyticsCreate()){return}if(googleAnalyticsIsGA4()){gtag("event","page_view",{page_title:pageTitle})}else if(googleAnalyticsIsUA()){ga("workpadTracker.send","pageview",pageTitle)}}function matomoTrackPage(pageTitle){if(typeof _paq!=="undefined"){_paq.push(["setCustomUrl","/"+pageTitle]);_paq.push(["setDocumentTitle",pageTitle]);_paq.push(["trackPageView"])}}function googleAnalyticsEvent(eventCategory,eventAction,eventLabel,eventValue){if(googleAnalyticsIsGA4()){gtag("event",eventAction,{event_category:eventCategory,event_label:eventLabel,value:eventValue})}else if(googleAnalyticsIsUA()){ga("workpadTracker.send","event",eventCategory,eventAction,eventLabel,eventValue)}}function googleAnalyticsTrackPrefix(){return"/"+(W["vanity_path"]||W["key"])+"/"}function displayWordpressCode(){modalOpen("share-task-wordpress",true,function(){var embed_url=getEmbedUrl(false,false,"wordpress");var booklet_width=6+parseInt(parseInt(W["width"]));var booklet_height=6+parseInt(parseInt(W["height"]));if(isPageSpread()){booklet_height=parseInt(booklet_height/2)}$("#wordpresscode_shortcode").val('[simplebooklet src="'+embed_url+'" width="'+booklet_width+'" height="'+booklet_height+'"]')})}function getSocialUrl(publishUrl,source){var url=typeof publishUrl!=="undefined"?publishUrl:W["publish_url"];var socialUrl;if(typeof url==="undefined"||url.length===0){socialUrl=rdpGetUrl({view:"publish",source:source})}else{var join=url.indexOf(".php?")<=0?"?":"&";socialUrl=url+join+"source="+source}return encodeURI(socialUrl)}function launchTwitter(publishUrl){var url=getSocialUrl(publishUrl,"twitter");url=url.replace(/^https/,"http");window.open("http://twitter.com/share?url="+url+"&text="+escape(W["name"]),"twitter","height=450,width=550")}function launchPinterest(publishUrl){var url=getSocialUrl(publishUrl,"pinterest");var pinterest_url="http://pinterest.com/pin/create/button/?"+"url="+url+"&media="+escape(getThumbUrl())+"&description="+escape(W["name"]+"\n"+W["comment"]+"\n"+"- made with simplebooklet.com");window.open(pinterest_url)}function launchLinkedin(publishUrl){var url=getSocialUrl(publishUrl,"linkedin");var linkedin_url="https://www.linkedin.com/shareArticle?"+"mini=true"+"&url="+encodeURIComponent(url)+"&title="+escape(W["name"])+"&source="+escape(location.protocol+"//"+document.domain);window.open(linkedin_url,"linkedin","width=580, height=520, scrollbars=1, resizable=1")}function launchGooglePlus(publishUrl){var url=getSocialUrl(publishUrl,"google_plus");window.open("https://plus.google.com/share?url="+url)}function setSocialTools(publishUrl){if(typeof publishUrl==="undefined"){if(typeof W["publish_url"]!=="undefined"){publishUrl=W["publish_url"]}}$(document).off("click",".publish_pinterest").on("click",".publish_pinterest",function(){launchPinterest(publishUrl)});$(document).off("click",".publish_linkedin").on("click",".publish_linkedin",function(){launchLinkedin(publishUrl)})}function createPages(lastPage){for(var create_page=0;create_page<=lastPage;create_page++){createPage(create_page)}}function createPage(page,setPages){var $pageDiv=$("#pageDiv_"+page);if($pageDiv.length){return $pageDiv}if(!$pageDiv.length){$pageDiv=$("<div />").attr("id","pageDiv_"+page).attr("page",page).addClass("pageDiv").addClass("page-"+page).addClass("page-"+(isOdd(page)?"odd":"even")).addClass("page").width(W["width"]).height(W["height"]);$global.gridDiv.append($pageDiv)}var styles=W["styles"];if(styles){var backgroundImage=!styles.backgroundImage||styles.backgroundImage==="undefined"||styles.backgroundImage==="none"?"none":"url('"+styles.backgroundImage+"')";$pageDiv.css("background",styles.backgroundColor).css("background-color",styles.backgroundColor).css("background-image",backgroundImage)}if(!editMode()&&isTurnJs()){$pageDiv.addClass("turnjs")}if(setPages){bookletSetPages()}return $pageDiv}function displayInitialModal(pid){if(DEV)console.log("displayInitialModal loaded: ",pid);if(!pid){return}var pageName=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);if(pageName.indexOf("embed")>=0){return}if(pid==="public-vertical-card-email"){post_load_modal_queue.push(function(){bookletEmail()})}else if(pid==="mailchimp"){post_load_modal_queue.push(function(){modalOpen("mailchimp")})}else if(pid==="booklet-edit-name"){post_load_modal_queue.push(function(){modalOpen("booklet-edit-name",null,null,workpadNameValidate)})}else if(pid==="meeting-comments"&&typeof displayMeetingComments==="function"){post_load_modal_queue.push(function(){displayMeetingComments()})}else{post_load_modal_queue.push(function(){modalOpen(pid)})}processPostLoadModalQueue()}function setTheme(theme_name){if(theme_name){$("link.theme").remove();$("head").append($('<link rel="stylesheet" type="text/css" class="theme" />').attr("href","/css/themes/"+theme_name+".css"));$("body").attr("class",function(i,c){return c.replace(/\btheme_\S+/g,"")}).addClass("theme_"+theme_name)}}function scaleBooklet(includeHeight,setScale){var $bookletDiv=$global.bookletDiv;if(!$bookletDiv)return;if(editMode()){$bookletDiv.css("transform","");$bookletDiv.css("margin-top","");$("#edit-page-tools").css("margin-left","");return}bookletWheelPanReset();var bookletMargin=parseInt($(".bookletContainer").css("margin"))||BOOKLET_MARGIN_TOP_BOTTOM;var mobileMargin=$global.mobile?bookletMargin:0;var windowWidth=$global.mobile?document.documentElement.clientWidth-mobileMargin:Math.min($bookletDiv.parent().width(),window.innerWidth);var windowHeight=$global.mobile?document.documentElement.clientHeight-mobileMargin:Math.min($bookletDiv.parent().height(),window.innerHeight);var bookletWidth=$bookletDiv.outerWidth()*getBookletFoldWidth();var bookletHeight=$bookletDiv.outerHeight();windowWidth-=typeof narrationModalWidth==="function"?narrationModalWidth()+10:0;if(isTrifold()&&W["transition_direction"]==="vertical"){windowWidth=+windowHeight}var wixWidth=parseQueryString("width");var wixHeight=parseQueryString("height");if(windowWidth===0){windowWidth=bookletWidth}if(windowHeight===0){windowHeight=bookletHeight}if(IOS&&isWix()){if(wixWidth){$("body").width(wixWidth);windowWidth=wixWidth}if(wixHeight){$("body").height(wixHeight);windowHeight=wixHeight}}bookletWidth=isPageSpread()?W["width"]*2:bookletWidth;var topNavHeight=$(".top-nav").height()||0;var bookletTopNavHeight=$(".booklet-page-nav.top-only:visible").height()||0;var bookletBottomNavHeight=$(".booklet-page-nav.bottom-only:visible").height()||0;bookletTopNavHeight+=topNavHeight;var navHeight=bookletTopNavHeight+bookletBottomNavHeight+2*bookletMargin;var viewHeight=windowHeight-navHeight;$global.bookletScale=1;var scale;if(setScale){scale=setScale}else{var widthRatio=windowWidth/bookletWidth;var heightRatio=viewHeight/bookletHeight;scale=includeHeight&&heightRatio<widthRatio?heightRatio:widthRatio}var bookletSpacing=Math.ceil((windowHeight-navHeight-bookletHeight)/2);var scaledBookletSpacing=Math.ceil((windowHeight-navHeight-bookletHeight*scale)/2);var top=bookletTopNavHeight+bookletMargin+bookletSpacing-(scaledBookletSpacing<0?scaledBookletSpacing:0);$global.bookletScale=scale;$bookletDiv.css("top",top+"px");bookletDivSetTransform();if(embed()||$global.mobile){$("body, .booklet-container").css("height",windowHeight+"px")}setBookletDraggable()}function bookletDivSetTransform(){var scale=$global.bookletScale;var rotate=(isTrifold()||isGatefold())&&W["transition_direction"]==="vertical"?" rotate(90deg)":"";$global.bookletDiv.css("transform","scale("+scale+","+scale+")"+rotate)}function isWix(){var wix=parseInt(parseQueryString("wix")||0);var bodyHasWix=$("body").hasClass("wix");return bodyHasWix||wix}function scaleBookletToDevice(){if(usePf5){if(IOS&&isWix()){$("#pageflip").height(parseQueryString("height"))}return}$(function(){if($global.edit){scaleBooklet()}else if($global.embed||$global.mobile){if(IOS&&inIframe()){setTimeout(function(){scaleBooklet(true)},3e3)}else{scaleBooklet(true)}}else{scaleBookletBySettings()}})}function scaleBookletBySettings(){if(W["scale"]==="fit"){scaleBooklet(true)}else if(W["scale"]==="fit-width"){scaleBooklet(false)}else{scaleBooklet(false,1)}bookletScales=setBookletScales(bookletScales,$global.bookletScale)}function setBookletScales(scaleList,currentScale){if(scaleList.indexOf(currentScale)>=0){return scaleList}var closestDiff=1e3;var closestScale=null;for(var i=0;i<scaleList.length;i++){var diff=Math.abs(scaleList[i]-currentScale);if(diff<closestDiff){closestDiff=diff;closestScale=i}}scaleList.splice(closestScale,1);scaleList.push(currentScale);scaleList.sort();return scaleList}$(document).on("click","#increaseScale",function(){if(usePf5){pageflip.zoomIn();Materialize.toast("Click and drag up or down to view the whole booklet.",4e3);setTimeout(zoomInTopCorrection,500);return}var s=$global.bookletScale;for(var i in bookletScales){if(bookletScales[i]>s){return scaleBooklet(false,bookletScales[i])}}});$(document).on("click","#decreaseScale",function(){if(usePf5){var $pf=$("#pageflip");var originalHeight=$pf.data("originalHeight");if(originalHeight){$pf.height(originalHeight)}pageflip.zoomOut();return}var s=$global.bookletScale;for(var i=bookletScales.length-1;i>=0;i--){if(bookletScales[i]<s){return scaleBooklet(false,bookletScales[i])}}});function embed(){return window.location.href.indexOf("embed.php")>0}$(window).resize(function(e){if($(e.target).hasClass("ui-resizable")||editMode()){return}$("#loadingImg").height($(document).height());setBookletPosition();if(!usePf5){if(isWix()){$global.bookletDiv.parent().width(window.innerWidth).height(window.innerHeight)}if(HANDHELD){scaleBooklet(true)}else{scaleBookletBySettings()}}else{$("#pf-stage").height($("#pageflip").height())}});function get_image_url_base(){var domain=document.domain;return location.protocol+"//"+domain}function get_image_preview_url(width){var url_base=get_image_url_base();var width_path=width?"/w"+width:"";return url_base+"/thumbs"+width_path+"/"+W["key"]+".jpg"}$(document).on("click",".resultDiv.type-BUTTON_BUY ",function(){if(editMode()){return true}var url=$(this).find(".action-button-buy").data("buy_url");window.open(url,"_blank")});$(document).on("click",".resultDiv.LEAD, .nav_handle.LEAD, .resultDiv.type-BUTTON_GOOGLE_SPREADSHEET, .resultDiv.type-BUTTON_GOOGLE_PRESENTATION",function(){if(editMode()){return true}var $result=$(this);var workpad_entry_id=$result.data("id");var workpad_entry_data=workpadEntries[workpad_entry_id];var leadType=workpad_entry_data.content_type;var leadAction=leadTypeActions[leadType];if(typeof leadAction==="undefined"){console.log("unknown content_type for lead button click action: lead_type="+leadType);modalToast("Ooops, we're not sure what to do for this button.");return false}logEvent.call(this,leadType);if(typeof leadAction==="function"){if(leadType==="LEAD_FIND"){$(this).data("data",workpad_entry_data.data);return leadAction.call(this,workpad_entry_data.data)}return leadAction.call(this)}var page=+$global.currentPage;var json={page:page,workpad_entry_id:workpad_entry_id};modalOpen(leadAction,json,function(){var $popup=$("#"+leadAction);$popup.find("form").append("<input type='hidden' name='resultId' value='"+workpad_entry_id+"' />");setSocialTools()});return true});$(document).on("click",".resultDiv.action-lightbox-open, .resultDiv.type-BUTTON_LIGHTBOX_URL",function(){openLightbox($(this))});function openLightbox($this){if(editMode()){return true}var workpadEntryId=$this.data("id");var page=$this.closest(".pageDiv").attr("page");modalOpen("lightbox_url",{page:page,workpad_entry_id:workpadEntryId},function(popupId){var $popup=$("#"+popupId);$popup.find("form").append("<input type='hidden' name='resultId' value='"+workpadEntryId+"' />");setSocialTools()})}$(document).on("click",".event:not(.resultDiv.LEAD)",function(){logEvent.call(this,$(this).data("event-type"),$(this).data("parent-event-id"))});function logEvent(event_type,parent_event_id,data){var $eventElement=$(this);var isWorkpadEntry=$eventElement.hasClass("resultDiv");$.ajax({url:"/workpad/workpad_event_log/log_event",data:{workpad_id:W["id"],event_type:event_type,parent_event_id:parent_event_id,workpad_entry_id:isWorkpadEntry?$eventElement.data("id"):null,page:$global.currentPage,data:data}})}function resultImageToBackground($resultDiv){var page=$resultDiv.data("page");var width=$resultDiv.width();var height=$resultDiv.height();var x=$resultDiv.data("x");var y=$resultDiv.data("y");var url=$resultDiv.data("url");var sticky=$resultDiv.data("sticky");var $pageDiv=sticky==="1"?$(".pageDiv,.tocPagePreview"):$("#pageDiv_"+page+",.tocPagePreview_"+page);var filename=$resultDiv.data("filename");if(typeof filename==="string"&&filename.indexOf("userFiles")>=0){filename=isSafari()?filename.replace(new RegExp(".webp"+"$"),".jpg"):filename;url="/"+filename}$pageDiv.pushBackgroundImage(url,{repeat:"no-repeat",position:x+"px "+y+"px",size:width+"px "+height+"px"});if(editMode()){if(page===$global.currentPage){$("#removeBackground").show()}$("#resultBackground").hide();$resultDiv.fadeOut().removeClass("type-IMAGE").addClass("type-BACKGROUND").removeClass("clicked");if(!(page in $global.backgroundImages))$global.backgroundImages[page]=[];if(jQuery.inArray($resultDiv,$global.backgroundImages[page])===-1){$global.backgroundImages[page].push($resultDiv)}}}function isCardflip(){return!editMode()&&W["styles"]&&W["styles"].animation&&W["styles"].animation.indexOf("cardflip")>=0}function isCardflipVertical(){return isCardflip()&&W["styles"].animation&&W["styles"].animation.indexOf("vert")>=0}function isTrifold(){return W["styles"]&&W["styles"].animation&&W["styles"].animation.indexOf("cardflip-trifold")>=0}function isTrifoldNoFoldBack(){return IOS||W["styles"]&&W["styles"].animation&&W["styles"].animation.indexOf("cardflip-trifold-nofold")>=0}function isGatefold(){return W["styles"]&&W["styles"].animation&&W["styles"].animation.indexOf("cardflip-gatefold")>=0}function isGatefoldSingle(){return W["styles"]&&W["styles"].animation&&W["styles"].animation==="cardflip-gatefold-single"}function isWall(){if(editMode()){return false}if(typeof W!=="object"){return false}if(typeof W["styles"]!=="object"){return false}if(typeof W["styles"].animation!=="string"){return false}return W["styles"].animation.indexOf("wall")>=0}function isWallEnhanced(){return isWall()&&W["styles"].animation&&W["styles"].animation.indexOf("enhanced")}function wallOffset(){return isWallEnhanced()?ANIMATION_WALL_ENHANCED_OFFSET:ANIMATION_WALL_OFFSET}function isTurnJs(){if(MOBILE)return false;if(typeof W!=="undefined")if(typeof W["styles"]!=="undefined")if(typeof W["styles"].animation==="string")if(W["styles"].animation.indexOf("turn")===0)return true;return false}function isPageSpread(){if(!("styles"in W)||!("animation"in W["styles"])){return false}return usePf5&&W["styles"].animation.indexOf("turn_double")===0||W["styles"].animation.indexOf("cardflip-double")===0}function isShowingSinglePage(){return!isPageSpread()||isFirstPage()&&!isAlwaysOpened()||isLastPage()&&(isAlwaysOpened()?isEven($global.currentPage):isOdd($global.currentPage))}function isFirstPage(){return $global.currentPage===(isGatefoldSingle()?1:$global.firstPage)}function isLastPage(){return $global.currentPage===$global.lastPage}function isAlwaysOpened(){return usePf5&&W&&W.styles&&W.styles.always_opened==="1"}function openGoogleMapByAddressId(addressId){var windowReference=window.open();$.ajax({url:"/address/address/get_address",data:{address_id:addressId},error:function(){modalToast("We couldn't retrieve an address location at this time.")},success:function(json){if(json.status==="ok"&&json.data&&json.data.formatted){var address=json.data.formatted;windowReference.location="https://www.google.ca/maps/place/"+escape(address)}else if(json.status==="error"&&json.message){modalToast(json.message)}else{modalToast("An unknown error occurred.")}}})}function openLeadWebsite(url,clickAction){if(!url)return false;if(typeof clickAction==="undefined")clickAction="NEW_TAB";if(clickAction==="LIGHTBOX")modalOpen("lightbox_url",{url:url});else{$taget=clickAction==="CURRENT_TAB"?"_self":"_blank";window.open(url,$taget)}}(function($){$.fn.pushBackgroundImage=function(backgroundImage,options){var $this=$(this);$this.css("backgroundImage",'url("'+backgroundImage+'"),'+$this.css("background-image"));var repeat=options&&options.repeat?options.repeat:"repeat";$this.css("backgroundRepeat",repeat+","+$this.css("background-repeat"));var position=options&&options.position?options.position:"0% 0%";$this.css("backgroundPosition",position+","+$this.css("background-position"));var size=options&&options.size?options.size:"auto";$this.css("backgroundSize",size+","+$this.css("background-size"));return $this};$.fn.popBackgroundImage=function(){var $this=$(this);$this.css("backgroundImage",$this.css("background-image").replace(/^[^,]+,\s*/,""));$this.css("backgroundRepeat",$this.css("background-repeat").replace(/^[^,]+,\s*/,""));$this.css("backgroundPosition",$this.css("background-position").replace(/^[^,]+,\s*/,""));$this.css("backgroundSize",$this.css("background-size").replace(/^[^,]+,\s*/,""));return $this}})(jQuery);$.fn.extend({isImage:function(){var contentType=$(this).data("content_type");if($(this).hasClass("resultDiv")){return contentType==="IMAGE"}return false},isFroalaImage:function(){return $(this).hasClass("type-TEXT_FROALA_IMG")},isFroalaFitContainerImage:function(){return this.isFroalaImage()&&$(this).find(".froala-image-fit-container").length},isVideo:function(){if($(this).hasClass("resultDiv"))return $(this).data("content_type")==="VIDEO";return false},isText:function(){if($(this).hasClass("resultDiv")&&$(this).data("content_type"))return $(this).data("content_type").indexOf("TEXT")===0;return false}});$(document).ready(function(){processPostLoadModalQueue()});function processPostLoadModalQueue(){for(var i in post_load_modal_queue){post_load_modal_queue[i]()}post_load_modal_queue.length=0}function hasBorderShadow(){if(typeof W==="undefined"||typeof W["styles"]==="undefined"){return false}var styles=W["styles"];return styles["booklet_border_style"]===BOOKLET_SHADOW_CSS_CLASS}function setPf5BorderShadow(useShadow){if(usePf5){if(useShadow){$("#pf-dropshadow").show()}else{$("#pf-dropshadow").hide()}}}function isRightToLeft(){return!editMode()&&!(isTrifold()||isGatefold())&&W["transition_direction"]==="rtl"}$(document).on("change input","#page-range-slider",function(){var page=$(this).val();gotoPage(page-1,true)});function iframeOnload(page,autoplay){if((usePf5||page===0)&&autoplay&&hasVideos()){iframeOnloadAutoplayVideo.call(this,page)}resizeLocalIframe.call(this)}function resizeLocalIframe(){var src=$(this).attr("src");if(src&&src.indexOf("userFiles")>=0){var $iframe=$(this).contents().find("iframe");if($iframe.length){$iframe.attr("width","100%").attr("height","100%").css("width","100%").css("height","100%")}}}function setBookletPosition(){if(!usePf5){$global.bookletDiv.width(parseInt(W["width"])||$global.bookletDiv.data("defaultWidth"));$global.bookletDiv.height(parseInt(W["height"])||$global.bookletDiv.data("defaultHeight"));var marginOffset=typeof narrationModalWidth==="function"?narrationModalWidth():0;$global.bookletDiv.css("margin-left",-Math.floor(($global.bookletDiv.outerWidth()-marginOffset)/2)+"px");if(isWall()){$global.bookletDiv.css("top",parseInt(($("body").height()-$global.bookletDiv.height())/2)+"px")}}}$(document).on("click",".type-FILE a",function(){if(editMode()){return true}var filename=$(this).data("filename");if(filename){window.open(filename)}return false});function lazyLoadUpdate(){var pageThreshold=LAZYLOAD_PAGE_THRESHOLD;if(!bookletLazyLoad){return}bookletLazyLoad.update();var minPage=Math.max($global.currentPage-pageThreshold,0);var maxPage=Math.min($global.currentPage+pageThreshold,$global.lastPage);var pf5PageMultiplier=isPageSpread()?1:2;for(var pageNum=minPage;pageNum<=maxPage;pageNum++){var $pageDiv=$("#pageDiv_"+pageNum+", #page"+(pageNum*pf5PageMultiplier+1));$pageDiv.find("img,iframe,audio,video,source").each(function(){var $this=$(this);if($this.data("src")){$this.attr("src",$this.data("src")).data("src","")}})}}$(document).on("click",".pagecorner:not(.disable)",function(e){e.stopPropagation();var direction=$(this).hasClass("next")?1:-1;changePage(direction);return false});function createPageturnButtons(){var container=$("body");if(!$("#bookletPageNext").length){$("<div id='bookletPageNext' class='pagecorner rdp-pagecorner next'></div>").appendTo(container)}if(!$("#bookletPagePrev").length){$("<div id='bookletPagePrev' class='pagecorner rdp-pagecorner prev'></div>").appendTo(container)}}$(document).on("click","a.l",function(e){var href=$(this).attr("href");if(href.indexOf("#")===0){if(DEV)console.log("found internal link: ",href);var destDetail=$(this).data("dest-detail");if(DEV)console.log("destDetail typeof: ",typeof destDetail);if(destDetail.constructor===Array){e.stopImmediatePropagation();e.preventDefault();var page=destDetail[0]-1;if(DEV)console.log("page: ",page);gotoPage(page,true);if(DEV)console.log("trying to kill link click propagation 4");return false}}return true});$(document).on("mouseover","div.t:not(.click-checked)",function(){cloudConvertLink.call(this)});function cloudConvertLink(){if(!parseInt(W["link_autodetect"])){return}var text=$(this).text();var emailRegex=/[\w.-]+@\w+\.\w\w[\w.\/-]+/g;var urlRegex=/\b(https?:\/\/)?[\w-]+\.\w\w[\w.\/-?]+/g;var emails=text.match(emailRegex);var urls=text.match(urlRegex);var url=null;if(emails){var email=emails[0];url="mailto:"+email.replace(/(\.)$/g,"")}else if(urls){url=urls[0];url=url.replace(/(\.)$/g,"");if(/\d+\.\d+/.test(url)){url=null}else{url=url.indexOf("http")!==0?"http://"+url:url}}if(url){$(this).addClass("click-bound").data("url",url).css("cursor","pointer").click(function(){if(url.indexOf("mailto")===0){window.location.href=url}else{window.open(url)}})}$(this).addClass("click-checked")}function toggleFullscreen(publishUrl){var openNewTab=function(){window.open(publishUrl)};if(embed()&&!$("body").hasClass("state-chrome-fullscreen_tab-off")){openNewTab.call()}else{$(document.documentElement).toggleFullscreen(openNewTab,function(isFullscreen){setTimeout(function(){$(window).trigger("resize");if(isFullscreen&&!usePf5){scaleBookletToDevice()}},500)})}}function bookletWheelPan(e){e.preventDefault();var $rdpDiv=$global.rdpDiv;var x0=parseInt($rdpDiv.css("left"));var y0=parseInt($rdpDiv.css("top"));var x=x0;var y=y0;var viewWidth=$(window).innerWidth();var viewHeight=$(window).innerHeight();var scaledWidth=bookletGetWidth()*$global.bookletScale;var scaledHeight=W["height"]*$global.bookletScale;var minX=(viewWidth-scaledWidth)/(2*$global.bookletScale);var minY=(viewHeight-scaledHeight)/$global.bookletScale;var maxX=-minX;var maxY=0;var panned=false;if(scaledWidth>viewWidth){x-=parseInt(e.deltaX);x=x>maxX?maxX:x<minX?minX:x;if(x!==x0){panned=true}}if(scaledHeight>viewHeight){y-=parseInt(e.deltaY);y=y>maxY?maxY:y<minY?minY:y;if(y!==y0){panned=true}}console.log("minY, y ",minY,y);if(panned){$global.bookletWheelPanned=true;$rdpDiv.left(x).top(y);return false}return true}function bookletWheelPanReset(){if($global.bookletWheelPanned){$global.bookletWheelPanned=false;$global.rdpDiv.css("left","0").css("top","0")}}function getBookletFoldWidth(){var multiples=1;if(isTrifold()){var triFoldPageWidths=[1,2,3,isTrifoldNoFoldBack()?3:1];multiples=triFoldPageWidths[$global.currentPage]}else if(isGatefold()){var quadFoldPageWidths=[1,2,4,2];multiples=quadFoldPageWidths[Math.min($global.currentPage,3)]}return multiples}function bookletGetWidth(includePageSpread){var width=W["width"];var multiples=includePageSpread&&isPageSpread()?2:getBookletFoldWidth();return width*multiples}if(!editMode()&&!IOS){$(document).on("mousedown","#rdpDiv",function(){$(this).toggleClass("mousedown",$(this).hasClass("draggable"));return true});$(document).on("mouseup mouseleave","#rdpDiv",function(e){var prevMove=$(this).data("prevMove");if(prevMove){var oldX=prevMove.clientX/$global.bookletScale;var oldY=prevMove.clientY/$global.bookletScale;var newX=$global.rdpDiv.hasClass("draggable-x")?e.clientX/$global.bookletScale:oldX;var newY=$global.rdpDiv.hasClass("draggable-y")?e.clientY/$global.bookletScale:oldY;dragMomentum.start("rdpDiv",oldX,oldY,prevMove.timeStamp);dragMomentum.end("rdpDiv",newX,newY,e.timeStamp,gridCheckBoundaryPosition)}$(this).removeClass("dragging mousedown").data("lastMove",null).data("prevMove",null);return true});$(document).on("mousemove","#rdpDiv",function(e){var $this=$(this);if(!$this.hasClass("mousedown")){return true}$this.addClass("dragging");var lastMove=$this.data("lastMove");if(!lastMove){$this.data("lastMove",e);return true}var x=parseInt($this.css("margin-left"));var y=parseInt($this.css("margin-top"));var deltaX=(e.clientX-lastMove.clientX)/$global.bookletScale;var deltaY=(e.clientY-lastMove.clientY)/$global.bookletScale;if(DEV)console.log("moousemove y: ",y,e.clientY,lastMove.clientY,deltaY);var position=gridCheckBoundaryPosition({x:x+deltaX,y:y+deltaY});if(DEV)console.log("moousemove x, clientX, lastClientX, deltaX, position.x: ",x,e.clientX,lastMove.clientX,deltaX,position.x);if($global.rdpDiv.hasClass("draggable-x")){$this.css("margin-left",position.x+"px")}if($global.rdpDiv.hasClass("draggable-y")){$this.css("margin-top",position.y+"px")}$this.data("prevMove",lastMove);$this.data("lastMove",e)});function gridCheckBoundaryPosition(position){var xMax=Math.max((bookletGetWidth(true)*$global.bookletScale-window.innerWidth)/(2*$global.bookletScale),0);var yMax=0;var xMin=-xMax;var yMin=-Math.max((W.height*$global.bookletScale-window.innerHeight)/$global.bookletScale,0);if(position.x<xMin){position.x=xMin}if(position.y<yMin){position.y=yMin}if(position.x>xMax){position.x=xMax}if(position.y>yMax){position.y=yMax}return position}}function setBookletDraggable(){if(editMode())return;if($global.mobile)return;var draggableX=bookletGetWidth(true)*$global.bookletScale>window.innerWidth;var draggableY=W["height"]*$global.bookletScale>window.innerHeight;var draggable=draggableX||draggableY;$global.rdpDiv.toggleClass("draggable",draggable);$global.rdpDiv.toggleClass("draggable-x",draggableX);$global.rdpDiv.toggleClass("draggable-y",draggableY);if(draggable){if($("#rdpDivDragOverlay").length===0){$('<div id="rdpDivDragOverlay"></div>').appendTo($global.rdpDiv)}}else{$("#rdpDivDragOverlay").remove()}if(!draggableX){$global.rdpDiv.animate({"margin-left":0},300)}if(!draggableY){$global.rdpDiv.animate({"margin-top":0},300)}}var dragMomentum=new function(){var howMuch=500;var minDrift=0;var easeType="easeOutQuad";var animateTime=700;var maxSpeed=3;var dXa=[0];var dYa=[0];var dTa=[0];this.start=function(elemId,Xa,Ya,Ta){dXa[elemId]=Xa;dYa[elemId]=Ya;dTa[elemId]=Ta};this.end=function(elemId,Xb,Yb,Tb,checkLimits){var $elem=$("#"+elemId);var Xa=dXa[elemId];var Ya=dYa[elemId];var Ta=dTa[elemId];var Xc=0;var Yc=0;var dDist=Math.sqrt(Math.pow(Xa-Xb,2)+Math.pow(Ya-Yb,2));var dTime=Tb-Ta;if(dTime<=0)return false;var dSpeed=dDist/dTime;dSpeed=Math.round(dSpeed*100)/100;if(dSpeed>maxSpeed){dSpeed=maxSpeed}var distX=Math.abs(Xa-Xb);var distY=Math.abs(Ya-Yb);if(distX+distY<.01){return false}var dVelX=minDrift+Math.round(distX*dSpeed*howMuch/(distX+distY));var dVelY=minDrift+Math.round(distY*dSpeed*howMuch/(distX+distY));var locX=parseInt($elem.css("margin-left"));var locY=parseInt($elem.css("margin-top"));if(dSpeed<=.06){return false}if(Xa>Xb){Xc=locX-dVelX}else{Xc=locX+dVelX}if(Ya>Yb){Yc=locY-dVelY}else{Yc=locY+dVelY}if(typeof checkLimits==="function"){var newPosition=checkLimits({x:Xc,y:Yc});Xc=newPosition.x;Yc=newPosition.y}var newLocX=Xc+"px";var newLocY=Yc+"px";$elem.addClass("animating").animate({marginLeft:newLocX,marginTop:newLocY},animateTime,easeType,function(){$(this).removeClass("animating")})}};function videoEndCredit(){var displayPage="body";$(".video-title-overlay").appendTo(displayPage).addClass("show");setTimeout(function(){$(".video-title-overlay").css("opacity",1)},1e3)}function setVideoEndCreditPage(pageNum){$global.videoEndCreditPage=pageNum}function linkFlash(page){if(imageMode()){return}var $page=isTrifold()||isGatefold()?$(".page"):pageContainer(usePf5?page*(isPageSpread()?1:2):page);$page.find("div.t:not(.click-checked)").each(cloudConvertLink);$page.find("a,.cursor-pointer:not(.LEAD),.click-bound,a.l>div").not(".link-flash,.animate").each(function(){$(this).addClass("link-flash click-bound").effect("highlight",{color:"#ffeb3b"},2e3,function(){$(this).removeClass("link-flash")})})}$(document).on("click",".action-addimageresult-display",function(){modalOpen("button-addimageresult",{workpad_entry_id:$(this).data("id")})});$(document).on("click",".action-addcaptionresult-display",function(){modalOpen("button-addcaptionresult",{workpad_entry_id:$(this).data("id")})});function addPageAudio(audioUrl){if(audioUrl){var audioElement=document.createElement("audio");audioElement.setAttribute("src",audioUrl);$global.pageAudio=audioElement;$global.pageAudio.volume=.1}else{$global.pageAudio=null}}function paywallPrompt(workpadId){if(authorMode()){return}if(workpadId&&typeof workpadPaywallStartPage!=="undefined"&&workpadPaywallStartPage!==false&&$global.currentPage>=workpadPaywallStartPage){if($global.currentPage>workpadPaywallStartPage){gotoPage(workpadPaywallStartPage)}if(!isPaywallOpen()){modalOpen("paywall-gateway",{},function(){paypalButton(workpadId)})}}}function isPaywallOpen(){return $("#paywall-gateway").is(":visible")}function leadGatePrompt(){if($global.leadGateOpened||authorMode()&&!previewMode()){return}var inviteKey=parseQueryString("invite_key")||"";if(+W["has_lead_gate"]&&W["lead_gate_start_page"]<=$global.currentPage&&inviteKey.length!==22){$global.leadGateOpened=true;modalOpen("lead_enterinfo",{wpKey:W["key"]},null,function(){typeof togglePageNarration==="function"&&togglePageNarration()})}}function isLeadgateOpen(){return $("#lead_enterinfo").is(":visible")}$(document).on("click",".action-leadgate-skip",function(){$.ajax({url:"/workpad/workpad_public/skip_lead_gate",data:{workpad_key:W["workpad_key"]}});modalClose()});function leadgateComplete($email,$name,$phone,$bizName){return!($email.length&&$email.val().trim().length===0||$phone.length&&$phone.val().trim().length===0||$name.length&&$name.val().trim().length===0||$bizName.length&&$bizName.val().trim().length===0)}function leadgateHasData($email,$name,$phone,$bizName){return $email.length&&$email.val().trim().length!==0||$phone.length&&$phone.val().trim().length!==0||$name.length&&$name.val().trim().length!==0||$bizName.length&&$bizName.val().trim().length!==0}$(document).on("click",".action-leadgate-submit",function(){var $form=$(this).closest("form");var $formError=$(".formerror");$formError.html("");var $name=$form.find("input[name=fullname]");var $phone=$form.find("input[name=phone]");var $email=$form.find("input[name=email]");var $bizName=$form.find("input[name=business_name]");var skip=+$form.find("input[name=skip]").val()===1;if(skip&&!leadgateHasData($email,$name,$phone,$bizName)){$(".action-leadgate-skip").trigger("click");modalClose();return false}else if(!skip&&!leadgateComplete($email,$name,$phone,$bizName)){$formError.html("This information is required.");return false}if($email.length){var email=$email.val().trim();if(email.length!==0)if(!validateEmail.test(email)){$formError.html("Email must have a valid format.");return false}}var data=$form.serialize();data.page=$global.currentPage;$.ajax({url:"/workpad/workpad_public/save_lead_gate",type:"POST",data:data,beforeSend:ajaxBefore,complete:ajaxComplete,success:function(json){if(json.status==="ok"){modalClose()}else{$(".formerror").html("Sorry, your information wasn't accepted. Please reload and try again or contact us at <a href='mailto:<?=SUPPORT_EMAIL?>'><?=SUPPORT_EMAIL?></a>.")}}});if(typeof email!=="undefined"&&email.length&&typeof pushKlaviyoEvent==="function"&&$(this).data("klaviyo")){pushKlaviyoEvent(W["name"],email,$name.val(),$phone.val(),$bizName.val())}return false});$(document).on("click",".action-accept-cookies",acceptCookies);function acceptCookies(){var date=new Date;document.cookie=ACCEPT_COOKIES_COOKIE_KEY+"=accept; expires="+date.setDate(date.getDate()+365)+"; path="+window.location.pathname;modalClose()}function hasAnimate(){return typeof animateElement==="function"}function hasVideos(){return typeof manageStartPageVideos==="function"}function activePages(page){if(isPageSpread())return activePagesPageSpread(page);if(isTrifold())return activePagesTrifold(page);if(isGatefold())return activePagesGatefold(page);return[page]}function activePagesPageSpread(page){var spreadPage=page+(isEven(page)?-1:1);return spreadPage>=1&&spreadPage<=$global.lastPage?[page,spreadPage]:[page]}function activePagesTrifold(page){var trifoldPagesByPage={0:[0],1:[1,4],2:[1,2,3],3:[4,5,0]};return trifoldPagesByPage[+page]||[0]}function activePagesGatefold(page){var gatefoldPagesByPage={0:[0],1:[1,2],2:[3,4,5,6],3:[2,7,0,1]};return gatefoldPagesByPage[+page]||[0]}function removeBackgroundFromPage(page){$(".page-"+page).css("background-image","")}function isPwa(){return typeof isStandalone==="function"&&isStandalone()}function loadEmbedCode(){jsLoad("/js/booklet_embed.js",typeof setEmbedCode,function(){setEmbedCode()})}window.addEventListener("message",function(event){if(event.origin!=="https://"+BASE_DOMAIN){if(DEV)console.log("Origin not allowed: ",event.origin,BASE_DOMAIN);return}if(event.data.command==="bookletEmail"){bookletEmail(event.data.argument)}});
!function(){"use strict";function e(e,t){if(e){if(t.element_.classList.contains(t.CssClasses_.MDL_JS_RIPPLE_EFFECT)){var s=document.createElement("span");s.classList.add(t.CssClasses_.MDL_RIPPLE_CONTAINER),s.classList.add(t.CssClasses_.MDL_JS_RIPPLE_EFFECT);var i=document.createElement("span");i.classList.add(t.CssClasses_.MDL_RIPPLE),s.appendChild(i),e.appendChild(s)}e.addEventListener("click",function(s){if("#"===e.getAttribute("href").charAt(0)){s.preventDefault();var i=e.href.split("#")[1],n=t.element_.querySelector("#"+i);t.resetTabState_(),t.resetPanelState_(),e.classList.add(t.CssClasses_.ACTIVE_CLASS),n.classList.add(t.CssClasses_.ACTIVE_CLASS)}})}}function t(e,t,s,i){function n(){var n=e.href.split("#")[1],a=i.content_.querySelector("#"+n);i.resetTabState_(t),i.resetPanelState_(s),e.classList.add(i.CssClasses_.IS_ACTIVE),a.classList.add(i.CssClasses_.IS_ACTIVE)}if(i.tabBar_.classList.contains(i.CssClasses_.JS_RIPPLE_EFFECT)){var a=document.createElement("span");a.classList.add(i.CssClasses_.RIPPLE_CONTAINER),a.classList.add(i.CssClasses_.JS_RIPPLE_EFFECT);var l=document.createElement("span");l.classList.add(i.CssClasses_.RIPPLE),a.appendChild(l),e.appendChild(a)}i.tabBar_.classList.contains(i.CssClasses_.TAB_MANUAL_SWITCH)||e.addEventListener("click",function(t){"#"===e.getAttribute("href").charAt(0)&&(t.preventDefault(),n())}),e.show=n}var s={upgradeDom:function(e,t){},upgradeElement:function(e,t){},upgradeElements:function(e){},upgradeAllRegistered:function(){},registerUpgradedCallback:function(e,t){},register:function(e){},downgradeElements:function(e){}};s=function(){function e(e,t){for(var s=0;s<c.length;s++)if(c[s].className===e)return"undefined"!=typeof t&&(c[s]=t),c[s];return!1}function t(e){var t=e.getAttribute("data-upgraded");return null===t?[""]:t.split(",")}function s(e,s){var i=t(e);return i.indexOf(s)!==-1}function i(e,t,s){if("CustomEvent"in window&&"function"==typeof window.CustomEvent)return new CustomEvent(e,{bubbles:t,cancelable:s});var i=document.createEvent("Events");return i.initEvent(e,t,s),i}function n(t,s){if("undefined"==typeof t&&"undefined"==typeof s)for(var i=0;i<c.length;i++)n(c[i].className,c[i].cssClass);else{var l=t;if("undefined"==typeof s){var o=e(l);o&&(s=o.cssClass)}for(var r=document.querySelectorAll("."+s),_=0;_<r.length;_++)a(r[_],l)}}function a(n,a){if(!("object"==typeof n&&n instanceof Element))throw new Error("Invalid argument provided to upgrade MDL element.");var l=i("mdl-componentupgrading",!0,!0);if(n.dispatchEvent(l),!l.defaultPrevented){var o=t(n),r=[];if(a)s(n,a)||r.push(e(a));else{var _=n.classList;c.forEach(function(e){_.contains(e.cssClass)&&r.indexOf(e)===-1&&!s(n,e.className)&&r.push(e)})}for(var d,h=0,u=r.length;h<u;h++){if(d=r[h],!d)throw new Error("Unable to find a registered component for the given class.");o.push(d.className),n.setAttribute("data-upgraded",o.join(","));var E=new d.classConstructor(n);E[C]=d,p.push(E);for(var m=0,L=d.callbacks.length;m<L;m++)d.callbacks[m](n);d.widget&&(n[d.className]=E);var I=i("mdl-componentupgraded",!0,!1);n.dispatchEvent(I)}}}function l(e){Array.isArray(e)||(e=e instanceof Element?[e]:Array.prototype.slice.call(e));for(var t,s=0,i=e.length;s<i;s++)t=e[s],t instanceof HTMLElement&&(a(t),t.children.length>0&&l(t.children))}function o(t){var s="undefined"==typeof t.widget&&"undefined"==typeof t.widget,i=!0;s||(i=t.widget||t.widget);var n={classConstructor:t.constructor||t.constructor,className:t.classAsString||t.classAsString,cssClass:t.cssClass||t.cssClass,widget:i,callbacks:[]};if(c.forEach(function(e){if(e.cssClass===n.cssClass)throw new Error("The provided cssClass has already been registered: "+e.cssClass);if(e.className===n.className)throw new Error("The provided className has already been registered")}),t.constructor.prototype.hasOwnProperty(C))throw new Error("MDL component classes must not have "+C+" defined as a property.");var a=e(t.classAsString,n);a||c.push(n)}function r(t,s){var i=e(t);i&&i.callbacks.push(s)}function _(){for(var e=0;e<c.length;e++)n(c[e].className)}function d(e){if(e){var t=p.indexOf(e);p.splice(t,1);var s=e.element_.getAttribute("data-upgraded").split(","),n=s.indexOf(e[C].classAsString);s.splice(n,1),e.element_.setAttribute("data-upgraded",s.join(","));var a=i("mdl-componentdowngraded",!0,!1);e.element_.dispatchEvent(a)}}function h(e){var t=function(e){p.filter(function(t){return t.element_===e}).forEach(d)};if(e instanceof Array||e instanceof NodeList)for(var s=0;s<e.length;s++)t(e[s]);else{if(!(e instanceof Node))throw new Error("Invalid argument provided to downgrade MDL nodes.");t(e)}}var c=[],p=[],C="mdlComponentConfigInternal_";return{upgradeDom:n,upgradeElement:a,upgradeElements:l,upgradeAllRegistered:_,registerUpgradedCallback:r,register:o,downgradeElements:h}}(),s.ComponentConfigPublic,s.ComponentConfig,s.Component,s.upgradeDom=s.upgradeDom,s.upgradeElement=s.upgradeElement,s.upgradeElements=s.upgradeElements,s.upgradeAllRegistered=s.upgradeAllRegistered,s.registerUpgradedCallback=s.registerUpgradedCallback,s.register=s.register,s.downgradeElements=s.downgradeElements,window.componentHandler=s,window.componentHandler=s,window.addEventListener("load",function(){"classList"in document.createElement("div")&&"querySelector"in document&&"addEventListener"in window&&Array.prototype.forEach?(document.documentElement.classList.add("mdl-js"),s.upgradeAllRegistered()):(s.upgradeElement=function(){},s.register=function(){})}),Date.now||(Date.now=function(){return(new Date).getTime()},Date.now=Date.now);for(var i=["webkit","moz"],n=0;n<i.length&&!window.requestAnimationFrame;++n){var a=i[n];window.requestAnimationFrame=window[a+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a+"CancelAnimationFrame"]||window[a+"CancelRequestAnimationFrame"],window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var l=0;window.requestAnimationFrame=function(e){var t=Date.now(),s=Math.max(l+16,t);return setTimeout(function(){e(l=s)},s-t)},window.cancelAnimationFrame=clearTimeout,window.requestAnimationFrame=window.requestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame}var o=function(e){this.element_=e,this.init()};window.MaterialButton=o,o.prototype.Constant_={},o.prototype.CssClasses_={RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_CONTAINER:"mdl-button__ripple-container",RIPPLE:"mdl-ripple"},o.prototype.blurHandler_=function(e){e&&this.element_.blur()},o.prototype.disable=function(){this.element_.disabled=!0},o.prototype.disable=o.prototype.disable,o.prototype.enable=function(){this.element_.disabled=!1},o.prototype.enable=o.prototype.enable,o.prototype.init=function(){if(this.element_){if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleElement_=document.createElement("span"),this.rippleElement_.classList.add(this.CssClasses_.RIPPLE),e.appendChild(this.rippleElement_),this.boundRippleBlurHandler=this.blurHandler_.bind(this),this.rippleElement_.addEventListener("mouseup",this.boundRippleBlurHandler),this.element_.appendChild(e)}this.boundButtonBlurHandler=this.blurHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundButtonBlurHandler),this.element_.addEventListener("mouseleave",this.boundButtonBlurHandler)}},s.register({constructor:o,classAsString:"MaterialButton",cssClass:"mdl-js-button",widget:!0});var r=function(e){this.element_=e,this.init()};window.MaterialCheckbox=r,r.prototype.Constant_={TINY_TIMEOUT:.001},r.prototype.CssClasses_={INPUT:"mdl-checkbox__input",BOX_OUTLINE:"mdl-checkbox__box-outline",FOCUS_HELPER:"mdl-checkbox__focus-helper",TICK_OUTLINE:"mdl-checkbox__tick-outline",RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE_CONTAINER:"mdl-checkbox__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded"},r.prototype.onChange_=function(e){this.updateClasses_()},r.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},r.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},r.prototype.onMouseUp_=function(e){this.blur_()},r.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},r.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},r.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},r.prototype.checkToggleState=r.prototype.checkToggleState,r.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},r.prototype.checkDisabled=r.prototype.checkDisabled,r.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},r.prototype.disable=r.prototype.disable,r.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},r.prototype.enable=r.prototype.enable,r.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},r.prototype.check=r.prototype.check,r.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},r.prototype.uncheck=r.prototype.uncheck,r.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("span");e.classList.add(this.CssClasses_.BOX_OUTLINE);var t=document.createElement("span");t.classList.add(this.CssClasses_.FOCUS_HELPER);var s=document.createElement("span");if(s.classList.add(this.CssClasses_.TICK_OUTLINE),e.appendChild(s),this.element_.appendChild(t),this.element_.appendChild(e),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var i=document.createElement("span");i.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(i),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementMouseUp),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},s.register({constructor:r,classAsString:"MaterialCheckbox",cssClass:"mdl-js-checkbox",widget:!0});var _=function(e){this.element_=e,this.init()};window.MaterialIconToggle=_,_.prototype.Constant_={TINY_TIMEOUT:.001},_.prototype.CssClasses_={INPUT:"mdl-icon-toggle__input",JS_RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE_CONTAINER:"mdl-icon-toggle__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},_.prototype.onChange_=function(e){this.updateClasses_()},_.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},_.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},_.prototype.onMouseUp_=function(e){this.blur_()},_.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},_.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},_.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},_.prototype.checkToggleState=_.prototype.checkToggleState,_.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},_.prototype.checkDisabled=_.prototype.checkDisabled,_.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},_.prototype.disable=_.prototype.disable,_.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},_.prototype.enable=_.prototype.enable,_.prototype.check=function(){this.inputElement_.checked=!0,this.updateClasses_()},_.prototype.check=_.prototype.check,_.prototype.uncheck=function(){this.inputElement_.checked=!1,this.updateClasses_()},_.prototype.uncheck=_.prototype.uncheck,_.prototype.init=function(){if(this.element_){if(this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.element_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.JS_RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.boundRippleMouseUp=this.onMouseUp_.bind(this),this.rippleContainerElement_.addEventListener("mouseup",this.boundRippleMouseUp);var e=document.createElement("span");e.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(e),this.element_.appendChild(this.rippleContainerElement_)}this.boundInputOnChange=this.onChange_.bind(this),this.boundInputOnFocus=this.onFocus_.bind(this),this.boundInputOnBlur=this.onBlur_.bind(this),this.boundElementOnMouseUp=this.onMouseUp_.bind(this),this.inputElement_.addEventListener("change",this.boundInputOnChange),this.inputElement_.addEventListener("focus",this.boundInputOnFocus),this.inputElement_.addEventListener("blur",this.boundInputOnBlur),this.element_.addEventListener("mouseup",this.boundElementOnMouseUp),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},s.register({constructor:_,classAsString:"MaterialIconToggle",cssClass:"mdl-js-icon-toggle",widget:!0});var d=function(e){this.element_=e,this.init()};window.MaterialMenu=d,d.prototype.Constant_={TRANSITION_DURATION_SECONDS:.3,TRANSITION_DURATION_FRACTION:.8,CLOSE_TIMEOUT:150},d.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32,UP_ARROW:38,DOWN_ARROW:40},d.prototype.CssClasses_={CONTAINER:"mdl-menu__container",OUTLINE:"mdl-menu__outline",ITEM:"mdl-menu__item",ITEM_RIPPLE_CONTAINER:"mdl-menu__item-ripple-container",RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE:"mdl-ripple",IS_UPGRADED:"is-upgraded",IS_VISIBLE:"is-visible",IS_ANIMATING:"is-animating",BOTTOM_LEFT:"mdl-menu--bottom-left",BOTTOM_RIGHT:"mdl-menu--bottom-right",TOP_LEFT:"mdl-menu--top-left",TOP_RIGHT:"mdl-menu--top-right",UNALIGNED:"mdl-menu--unaligned"},d.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),this.container_=e;var t=document.createElement("div");t.classList.add(this.CssClasses_.OUTLINE),this.outline_=t,e.insertBefore(t,this.element_);var s=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for"),i=null;s&&(i=document.getElementById(s),i&&(this.forElement_=i,i.addEventListener("click",this.handleForClick_.bind(this)),i.addEventListener("keydown",this.handleForKeyboardEvent_.bind(this))));var n=this.element_.querySelectorAll("."+this.CssClasses_.ITEM);this.boundItemKeydown_=this.handleItemKeyboardEvent_.bind(this),this.boundItemClick_=this.handleItemClick_.bind(this);for(var a=0;a<n.length;a++)n[a].addEventListener("click",this.boundItemClick_),n[a].tabIndex="-1",n[a].addEventListener("keydown",this.boundItemKeydown_);if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT))for(this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),a=0;a<n.length;a++){var l=n[a],o=document.createElement("span");o.classList.add(this.CssClasses_.ITEM_RIPPLE_CONTAINER);var r=document.createElement("span");r.classList.add(this.CssClasses_.RIPPLE),o.appendChild(r),l.appendChild(o),l.classList.add(this.CssClasses_.RIPPLE_EFFECT)}this.element_.classList.contains(this.CssClasses_.BOTTOM_LEFT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_LEFT),this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)&&this.outline_.classList.add(this.CssClasses_.BOTTOM_RIGHT),this.element_.classList.contains(this.CssClasses_.TOP_LEFT)&&this.outline_.classList.add(this.CssClasses_.TOP_LEFT),this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)&&this.outline_.classList.add(this.CssClasses_.TOP_RIGHT),this.element_.classList.contains(this.CssClasses_.UNALIGNED)&&this.outline_.classList.add(this.CssClasses_.UNALIGNED),e.classList.add(this.CssClasses_.IS_UPGRADED)}},d.prototype.handleForClick_=function(e){if(this.element_&&this.forElement_){var t=this.forElement_.getBoundingClientRect(),s=this.forElement_.parentElement.getBoundingClientRect();this.element_.classList.contains(this.CssClasses_.UNALIGNED)||(this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?(this.container_.style.right=s.right-t.right+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"):this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.bottom=s.bottom-t.top+"px"):this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(this.container_.style.right=s.right-t.right+"px",this.container_.style.bottom=s.bottom-t.top+"px"):(this.container_.style.left=this.forElement_.offsetLeft+"px",this.container_.style.top=this.forElement_.offsetTop+this.forElement_.offsetHeight+"px"))}this.toggle(e)},d.prototype.handleForKeyboardEvent_=function(e){if(this.element_&&this.container_&&this.forElement_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)&&(e.keyCode===this.Keycodes_.UP_ARROW?(e.preventDefault(),t[t.length-1].focus()):e.keyCode===this.Keycodes_.DOWN_ARROW&&(e.preventDefault(),t[0].focus()))}},d.prototype.handleItemKeyboardEvent_=function(e){if(this.element_&&this.container_){var t=this.element_.querySelectorAll("."+this.CssClasses_.ITEM+":not([disabled])");if(t&&t.length>0&&this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)){var s=Array.prototype.slice.call(t).indexOf(e.target);if(e.keyCode===this.Keycodes_.UP_ARROW)e.preventDefault(),s>0?t[s-1].focus():t[t.length-1].focus();else if(e.keyCode===this.Keycodes_.DOWN_ARROW)e.preventDefault(),t.length>s+1?t[s+1].focus():t[0].focus();else if(e.keyCode===this.Keycodes_.SPACE||e.keyCode===this.Keycodes_.ENTER){e.preventDefault();var i=new MouseEvent("mousedown");e.target.dispatchEvent(i),i=new MouseEvent("mouseup"),e.target.dispatchEvent(i),e.target.click()}else e.keyCode===this.Keycodes_.ESCAPE&&(e.preventDefault(),this.hide())}}},d.prototype.handleItemClick_=function(e){e.target.hasAttribute("disabled")?e.stopPropagation():(this.closing_=!0,window.setTimeout(function(e){this.hide(),this.closing_=!1}.bind(this),this.Constant_.CLOSE_TIMEOUT))},d.prototype.applyClip_=function(e,t){this.element_.classList.contains(this.CssClasses_.UNALIGNED)?this.element_.style.clip="":this.element_.classList.contains(this.CssClasses_.BOTTOM_RIGHT)?this.element_.style.clip="rect(0 "+t+"px 0 "+t+"px)":this.element_.classList.contains(this.CssClasses_.TOP_LEFT)?this.element_.style.clip="rect("+e+"px 0 "+e+"px 0)":this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?this.element_.style.clip="rect("+e+"px "+t+"px "+e+"px "+t+"px)":this.element_.style.clip=""},d.prototype.removeAnimationEndListener_=function(e){e.target.classList.remove(d.prototype.CssClasses_.IS_ANIMATING)},d.prototype.addAnimationEndListener_=function(){this.element_.addEventListener("transitionend",this.removeAnimationEndListener_),this.element_.addEventListener("webkitTransitionEnd",this.removeAnimationEndListener_)},d.prototype.show=function(e){if(this.element_&&this.container_&&this.outline_){var t=this.element_.getBoundingClientRect().height,s=this.element_.getBoundingClientRect().width;this.container_.style.width=s+"px",this.container_.style.height=t+"px",this.outline_.style.width=s+"px",this.outline_.style.height=t+"px";for(var i=this.Constant_.TRANSITION_DURATION_SECONDS*this.Constant_.TRANSITION_DURATION_FRACTION,n=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),a=0;a<n.length;a++){var l=null;l=this.element_.classList.contains(this.CssClasses_.TOP_LEFT)||this.element_.classList.contains(this.CssClasses_.TOP_RIGHT)?(t-n[a].offsetTop-n[a].offsetHeight)/t*i+"s":n[a].offsetTop/t*i+"s",n[a].style.transitionDelay=l}this.applyClip_(t,s),window.requestAnimationFrame(function(){this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.element_.style.clip="rect(0 "+s+"px "+t+"px 0)",this.container_.classList.add(this.CssClasses_.IS_VISIBLE)}.bind(this)),this.addAnimationEndListener_();var o=function(t){t===e||this.closing_||t.target.parentNode===this.element_||(document.removeEventListener("click",o),this.hide())}.bind(this);document.addEventListener("click",o)}},d.prototype.show=d.prototype.show,d.prototype.hide=function(){if(this.element_&&this.container_&&this.outline_){for(var e=this.element_.querySelectorAll("."+this.CssClasses_.ITEM),t=0;t<e.length;t++)e[t].style.removeProperty("transition-delay");var s=this.element_.getBoundingClientRect(),i=s.height,n=s.width;this.element_.classList.add(this.CssClasses_.IS_ANIMATING),this.applyClip_(i,n),this.container_.classList.remove(this.CssClasses_.IS_VISIBLE),this.addAnimationEndListener_()}},d.prototype.hide=d.prototype.hide,d.prototype.toggle=function(e){this.container_.classList.contains(this.CssClasses_.IS_VISIBLE)?this.hide():this.show(e)},d.prototype.toggle=d.prototype.toggle,s.register({constructor:d,classAsString:"MaterialMenu",cssClass:"mdl-js-menu",widget:!0});var h=function(e){this.element_=e,this.init()};window.MaterialProgress=h,h.prototype.Constant_={},h.prototype.CssClasses_={INDETERMINATE_CLASS:"mdl-progress__indeterminate"},h.prototype.setProgress=function(e){this.element_.classList.contains(this.CssClasses_.INDETERMINATE_CLASS)||(this.progressbar_.style.width=e+"%")},h.prototype.setProgress=h.prototype.setProgress,h.prototype.setBuffer=function(e){this.bufferbar_.style.width=e+"%",this.auxbar_.style.width=100-e+"%"},h.prototype.setBuffer=h.prototype.setBuffer,h.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.className="progressbar bar bar1",this.element_.appendChild(e),this.progressbar_=e,e=document.createElement("div"),e.className="bufferbar bar bar2",this.element_.appendChild(e),this.bufferbar_=e,e=document.createElement("div"),e.className="auxbar bar bar3",this.element_.appendChild(e),this.auxbar_=e,this.progressbar_.style.width="0%",this.bufferbar_.style.width="100%",this.auxbar_.style.width="0%",this.element_.classList.add("is-upgraded")}},s.register({constructor:h,classAsString:"MaterialProgress",cssClass:"mdl-js-progress",widget:!0});var c=function(e){this.element_=e,this.init()};window.MaterialRadio=c,c.prototype.Constant_={TINY_TIMEOUT:.001},c.prototype.CssClasses_={IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked",IS_UPGRADED:"is-upgraded",JS_RADIO:"mdl-js-radio",RADIO_BTN:"mdl-radio__button",RADIO_OUTER_CIRCLE:"mdl-radio__outer-circle",RADIO_INNER_CIRCLE:"mdl-radio__inner-circle",RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE_CONTAINER:"mdl-radio__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple"},c.prototype.onChange_=function(e){for(var t=document.getElementsByClassName(this.CssClasses_.JS_RADIO),s=0;s<t.length;s++){var i=t[s].querySelector("."+this.CssClasses_.RADIO_BTN);i.getAttribute("name")===this.btnElement_.getAttribute("name")&&"undefined"!=typeof t[s].MaterialRadio&&t[s].MaterialRadio.updateClasses_()}},c.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},c.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},c.prototype.onMouseup_=function(e){this.blur_()},c.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},c.prototype.blur_=function(){window.setTimeout(function(){this.btnElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},c.prototype.checkDisabled=function(){this.btnElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},c.prototype.checkDisabled=c.prototype.checkDisabled,c.prototype.checkToggleState=function(){this.btnElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},c.prototype.checkToggleState=c.prototype.checkToggleState,c.prototype.disable=function(){this.btnElement_.disabled=!0,this.updateClasses_()},c.prototype.disable=c.prototype.disable,c.prototype.enable=function(){this.btnElement_.disabled=!1,this.updateClasses_()},c.prototype.enable=c.prototype.enable,c.prototype.check=function(){this.btnElement_.checked=!0,this.onChange_(null)},c.prototype.check=c.prototype.check,c.prototype.uncheck=function(){this.btnElement_.checked=!1,this.onChange_(null)},c.prototype.uncheck=c.prototype.uncheck,c.prototype.init=function(){if(this.element_){this.btnElement_=this.element_.querySelector("."+this.CssClasses_.RADIO_BTN),this.boundChangeHandler_=this.onChange_.bind(this),this.boundFocusHandler_=this.onChange_.bind(this),this.boundBlurHandler_=this.onBlur_.bind(this),this.boundMouseUpHandler_=this.onMouseup_.bind(this);var e=document.createElement("span");e.classList.add(this.CssClasses_.RADIO_OUTER_CIRCLE);var t=document.createElement("span");t.classList.add(this.CssClasses_.RADIO_INNER_CIRCLE),this.element_.appendChild(e),this.element_.appendChild(t);var s;if(this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),s=document.createElement("span"),s.classList.add(this.CssClasses_.RIPPLE_CONTAINER),s.classList.add(this.CssClasses_.RIPPLE_EFFECT),s.classList.add(this.CssClasses_.RIPPLE_CENTER),s.addEventListener("mouseup",this.boundMouseUpHandler_);var i=document.createElement("span");i.classList.add(this.CssClasses_.RIPPLE),s.appendChild(i),this.element_.appendChild(s)}this.btnElement_.addEventListener("change",this.boundChangeHandler_),this.btnElement_.addEventListener("focus",this.boundFocusHandler_),this.btnElement_.addEventListener("blur",this.boundBlurHandler_),this.element_.addEventListener("mouseup",this.boundMouseUpHandler_),this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},s.register({constructor:c,classAsString:"MaterialRadio",cssClass:"mdl-js-radio",widget:!0});var p=function(e){this.element_=e,this.isIE_=window.navigator.msPointerEnabled,this.init()};window.MaterialSlider=p,p.prototype.Constant_={},p.prototype.CssClasses_={IE_CONTAINER:"mdl-slider__ie-container",SLIDER_CONTAINER:"mdl-slider__container",BACKGROUND_FLEX:"mdl-slider__background-flex",BACKGROUND_LOWER:"mdl-slider__background-lower",BACKGROUND_UPPER:"mdl-slider__background-upper",IS_LOWEST_VALUE:"is-lowest-value",IS_UPGRADED:"is-upgraded"},p.prototype.onInput_=function(e){this.updateValueStyles_()},p.prototype.onChange_=function(e){this.updateValueStyles_()},p.prototype.onMouseUp_=function(e){e.target.blur()},p.prototype.onContainerMouseDown_=function(e){if(e.target===this.element_.parentElement){e.preventDefault();var t=new MouseEvent("mousedown",{target:e.target,buttons:e.buttons,clientX:e.clientX,clientY:this.element_.getBoundingClientRect().y});this.element_.dispatchEvent(t)}},p.prototype.updateValueStyles_=function(){var e=(this.element_.value-this.element_.min)/(this.element_.max-this.element_.min);0===e?this.element_.classList.add(this.CssClasses_.IS_LOWEST_VALUE):this.element_.classList.remove(this.CssClasses_.IS_LOWEST_VALUE),this.isIE_||(this.backgroundLower_.style.flex=e,this.backgroundLower_.style.webkitFlex=e,this.backgroundUpper_.style.flex=1-e,this.backgroundUpper_.style.webkitFlex=1-e)},p.prototype.disable=function(){this.element_.disabled=!0},p.prototype.disable=p.prototype.disable,p.prototype.enable=function(){this.element_.disabled=!1},p.prototype.enable=p.prototype.enable,p.prototype.change=function(e){"undefined"!=typeof e&&(this.element_.value=e),this.updateValueStyles_()},p.prototype.change=p.prototype.change,p.prototype.init=function(){if(this.element_){if(this.isIE_){var e=document.createElement("div");e.classList.add(this.CssClasses_.IE_CONTAINER),this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_)}else{var t=document.createElement("div");t.classList.add(this.CssClasses_.SLIDER_CONTAINER),this.element_.parentElement.insertBefore(t,this.element_),this.element_.parentElement.removeChild(this.element_),t.appendChild(this.element_);var s=document.createElement("div");s.classList.add(this.CssClasses_.BACKGROUND_FLEX),t.appendChild(s),this.backgroundLower_=document.createElement("div"),this.backgroundLower_.classList.add(this.CssClasses_.BACKGROUND_LOWER),s.appendChild(this.backgroundLower_),this.backgroundUpper_=document.createElement("div"),this.backgroundUpper_.classList.add(this.CssClasses_.BACKGROUND_UPPER),s.appendChild(this.backgroundUpper_)}this.boundInputHandler=this.onInput_.bind(this),this.boundChangeHandler=this.onChange_.bind(this),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.boundContainerMouseDownHandler=this.onContainerMouseDown_.bind(this),this.element_.addEventListener("input",this.boundInputHandler),this.element_.addEventListener("change",this.boundChangeHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.element_.parentElement.addEventListener("mousedown",this.boundContainerMouseDownHandler),this.updateValueStyles_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},s.register({constructor:p,classAsString:"MaterialSlider",cssClass:"mdl-js-slider",widget:!0});var C=function(e){if(this.element_=e,this.textElement_=this.element_.querySelector("."+this.cssClasses_.MESSAGE),this.actionElement_=this.element_.querySelector("."+this.cssClasses_.ACTION),!this.textElement_)throw new Error("There must be a message element for a snackbar.");if(!this.actionElement_)throw new Error("There must be an action element for a snackbar.");this.active=!1,this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.queuedNotifications_=[],this.setActionHidden_(!0)};window.MaterialSnackbar=C,C.prototype.Constant_={ANIMATION_LENGTH:250},C.prototype.cssClasses_={SNACKBAR:"mdl-snackbar",MESSAGE:"mdl-snackbar__text",ACTION:"mdl-snackbar__action",ACTIVE:"mdl-snackbar--active"},C.prototype.displaySnackbar_=function(){this.element_.setAttribute("aria-hidden","true"),this.actionHandler_&&(this.actionElement_.textContent=this.actionText_,this.actionElement_.addEventListener("click",this.actionHandler_),this.setActionHidden_(!1)),this.textElement_.textContent=this.message_,this.element_.classList.add(this.cssClasses_.ACTIVE),this.element_.setAttribute("aria-hidden","false"),setTimeout(this.cleanup_.bind(this),this.timeout_)},C.prototype.showSnackbar=function(e){if(void 0===e)throw new Error("Please provide a data object with at least a message to display.");if(void 0===e.message)throw new Error("Please provide a message to be displayed.");if(e.actionHandler&&!e.actionText)throw new Error("Please provide action text with the handler.");this.active?this.queuedNotifications_.push(e):(this.active=!0,this.message_=e.message,e.timeout?this.timeout_=e.timeout:this.timeout_=2750,e.actionHandler&&(this.actionHandler_=e.actionHandler),e.actionText&&(this.actionText_=e.actionText),this.displaySnackbar_())},C.prototype.showSnackbar=C.prototype.showSnackbar,C.prototype.checkQueue_=function(){this.queuedNotifications_.length>0&&this.showSnackbar(this.queuedNotifications_.shift())},C.prototype.cleanup_=function(){this.element_.classList.remove(this.cssClasses_.ACTIVE),setTimeout(function(){this.element_.setAttribute("aria-hidden","true"),this.textElement_.textContent="",Boolean(this.actionElement_.getAttribute("aria-hidden"))||(this.setActionHidden_(!0),this.actionElement_.textContent="",this.actionElement_.removeEventListener("click",this.actionHandler_)),this.actionHandler_=void 0,this.message_=void 0,this.actionText_=void 0,this.active=!1,this.checkQueue_()}.bind(this),this.Constant_.ANIMATION_LENGTH)},C.prototype.setActionHidden_=function(e){e?this.actionElement_.setAttribute("aria-hidden","true"):this.actionElement_.removeAttribute("aria-hidden")},s.register({constructor:C,classAsString:"MaterialSnackbar",cssClass:"mdl-js-snackbar",widget:!0});var u=function(e){this.element_=e,this.init()};window.MaterialSpinner=u,u.prototype.Constant_={MDL_SPINNER_LAYER_COUNT:4},u.prototype.CssClasses_={MDL_SPINNER_LAYER:"mdl-spinner__layer",MDL_SPINNER_CIRCLE_CLIPPER:"mdl-spinner__circle-clipper",MDL_SPINNER_CIRCLE:"mdl-spinner__circle",MDL_SPINNER_GAP_PATCH:"mdl-spinner__gap-patch",MDL_SPINNER_LEFT:"mdl-spinner__left",MDL_SPINNER_RIGHT:"mdl-spinner__right"},u.prototype.createLayer=function(e){var t=document.createElement("div");t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER),t.classList.add(this.CssClasses_.MDL_SPINNER_LAYER+"-"+e);var s=document.createElement("div");s.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),s.classList.add(this.CssClasses_.MDL_SPINNER_LEFT);var i=document.createElement("div");i.classList.add(this.CssClasses_.MDL_SPINNER_GAP_PATCH);var n=document.createElement("div");n.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE_CLIPPER),n.classList.add(this.CssClasses_.MDL_SPINNER_RIGHT);for(var a=[s,i,n],l=0;l<a.length;l++){var o=document.createElement("div");o.classList.add(this.CssClasses_.MDL_SPINNER_CIRCLE),a[l].appendChild(o)}t.appendChild(s),t.appendChild(i),t.appendChild(n),this.element_.appendChild(t)},u.prototype.createLayer=u.prototype.createLayer,u.prototype.stop=function(){this.element_.classList.remove("is-active")},u.prototype.stop=u.prototype.stop,u.prototype.start=function(){this.element_.classList.add("is-active")},u.prototype.start=u.prototype.start,u.prototype.init=function(){if(this.element_){for(var e=1;e<=this.Constant_.MDL_SPINNER_LAYER_COUNT;e++)this.createLayer(e);this.element_.classList.add("is-upgraded")}},s.register({constructor:u,classAsString:"MaterialSpinner",cssClass:"mdl-js-spinner",widget:!0});var E=function(e){this.element_=e,this.init()};window.MaterialSwitch=E,E.prototype.Constant_={TINY_TIMEOUT:.001},E.prototype.CssClasses_={INPUT:"mdl-switch__input",TRACK:"mdl-switch__track",THUMB:"mdl-switch__thumb",FOCUS_HELPER:"mdl-switch__focus-helper",RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE_CONTAINER:"mdl-switch__ripple-container",RIPPLE_CENTER:"mdl-ripple--center",RIPPLE:"mdl-ripple",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_CHECKED:"is-checked"},E.prototype.onChange_=function(e){this.updateClasses_()},E.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},E.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},E.prototype.onMouseUp_=function(e){this.blur_()},E.prototype.updateClasses_=function(){this.checkDisabled(),this.checkToggleState()},E.prototype.blur_=function(){window.setTimeout(function(){this.inputElement_.blur()}.bind(this),this.Constant_.TINY_TIMEOUT)},E.prototype.checkDisabled=function(){this.inputElement_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},E.prototype.checkDisabled=E.prototype.checkDisabled,E.prototype.checkToggleState=function(){this.inputElement_.checked?this.element_.classList.add(this.CssClasses_.IS_CHECKED):this.element_.classList.remove(this.CssClasses_.IS_CHECKED)},E.prototype.checkToggleState=E.prototype.checkToggleState,E.prototype.disable=function(){this.inputElement_.disabled=!0,this.updateClasses_()},E.prototype.disable=E.prototype.disable,E.prototype.enable=function(){this.inputElement_.disabled=!1,this.updateClasses_()},E.prototype.enable=E.prototype.enable,E.prototype.on=function(){this.inputElement_.checked=!0,this.updateClasses_()},E.prototype.on=E.prototype.on,E.prototype.off=function(){this.inputElement_.checked=!1,this.updateClasses_()},E.prototype.off=E.prototype.off,E.prototype.init=function(){if(this.element_){this.inputElement_=this.element_.querySelector("."+this.CssClasses_.INPUT);var e=document.createElement("div");e.classList.add(this.CssClasses_.TRACK);var t=document.createElement("div");t.classList.add(this.CssClasses_.THUMB);var s=document.createElement("span");if(s.classList.add(this.CssClasses_.FOCUS_HELPER),t.appendChild(s),this.element_.appendChild(e),this.element_.appendChild(t),this.boundMouseUpHandler=this.onMouseUp_.bind(this),this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT)){this.element_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS),this.rippleContainerElement_=document.createElement("span"),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CONTAINER),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_EFFECT),this.rippleContainerElement_.classList.add(this.CssClasses_.RIPPLE_CENTER),this.rippleContainerElement_.addEventListener("mouseup",this.boundMouseUpHandler);var i=document.createElement("span");i.classList.add(this.CssClasses_.RIPPLE),this.rippleContainerElement_.appendChild(i),this.element_.appendChild(this.rippleContainerElement_)}this.boundChangeHandler=this.onChange_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.inputElement_.addEventListener("change",this.boundChangeHandler),this.inputElement_.addEventListener("focus",this.boundFocusHandler),this.inputElement_.addEventListener("blur",this.boundBlurHandler),this.element_.addEventListener("mouseup",this.boundMouseUpHandler),this.updateClasses_(),this.element_.classList.add("is-upgraded")}},s.register({constructor:E,classAsString:"MaterialSwitch",cssClass:"mdl-js-switch",widget:!0});var m=function(e){this.element_=e,this.init()};window.MaterialTabs=m,m.prototype.Constant_={},m.prototype.CssClasses_={TAB_CLASS:"mdl-tabs__tab",PANEL_CLASS:"mdl-tabs__panel",ACTIVE_CLASS:"is-active",UPGRADED_CLASS:"is-upgraded",MDL_JS_RIPPLE_EFFECT:"mdl_js_ripple_effect",MDL_RIPPLE_CONTAINER:"mdl-tabs__ripple-container",MDL_RIPPLE:"mdl-ripple",MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events"},m.prototype.initTabs_=function(){this.element_.classList.contains(this.CssClasses_.MDL_JS_RIPPLE_EFFECT)&&this.element_.classList.add(this.CssClasses_.MDL_JS_RIPPLE_EFFECT_IGNORE_EVENTS),this.tabs_=this.element_.querySelectorAll("."+this.CssClasses_.TAB_CLASS),this.panels_=this.element_.querySelectorAll("."+this.CssClasses_.PANEL_CLASS);for(var t=0;t<this.tabs_.length;t++)new e(this.tabs_[t],this);this.element_.classList.add(this.CssClasses_.UPGRADED_CLASS)},m.prototype.resetTabState_=function(){for(var e=0;e<this.tabs_.length;e++)this.tabs_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},m.prototype.resetPanelState_=function(){for(var e=0;e<this.panels_.length;e++)this.panels_[e].classList.remove(this.CssClasses_.ACTIVE_CLASS)},m.prototype.init=function(){this.element_&&this.initTabs_()},s.register({constructor:m,classAsString:"MaterialTabs",cssClass:"mdl-js-tabs"});var L=function(e){this.element_=e,this.maxRows=this.Constant_.NO_MAX_ROWS,this.init()};window.MaterialTextfield=L,L.prototype.Constant_={NO_MAX_ROWS:-1,MAX_ROWS_ATTRIBUTE:"maxrows"},L.prototype.CssClasses_={LABEL:"mdl-textfield__label",INPUT:"mdl-textfield__input",IS_DIRTY:"is-dirty",IS_FOCUSED:"is-focused",IS_DISABLED:"is-disabled",IS_INVALID:"is-invalid",IS_UPGRADED:"is-upgraded",HAS_PLACEHOLDER:"has-placeholder"},L.prototype.onKeyDown_=function(e){var t=e.target.value.split("\n").length;13===e.keyCode&&t>=this.maxRows&&e.preventDefault()},L.prototype.onFocus_=function(e){this.element_.classList.add(this.CssClasses_.IS_FOCUSED)},L.prototype.onBlur_=function(e){this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},L.prototype.onReset_=function(e){this.updateClasses_()},L.prototype.updateClasses_=function(){this.checkDisabled(),this.checkValidity(),this.checkDirty(),this.checkFocus()},L.prototype.checkDisabled=function(){this.input_.disabled?this.element_.classList.add(this.CssClasses_.IS_DISABLED):this.element_.classList.remove(this.CssClasses_.IS_DISABLED)},L.prototype.checkDisabled=L.prototype.checkDisabled,L.prototype.checkFocus=function(){Boolean(this.element_.querySelector(":focus"))?this.element_.classList.add(this.CssClasses_.IS_FOCUSED):this.element_.classList.remove(this.CssClasses_.IS_FOCUSED)},L.prototype.checkFocus=L.prototype.checkFocus,L.prototype.checkValidity=function(){this.input_.validity&&(this.input_.validity.valid?this.element_.classList.remove(this.CssClasses_.IS_INVALID):this.element_.classList.add(this.CssClasses_.IS_INVALID))},L.prototype.checkValidity=L.prototype.checkValidity,L.prototype.checkDirty=function(){this.input_.value&&this.input_.value.length>0?this.element_.classList.add(this.CssClasses_.IS_DIRTY):this.element_.classList.remove(this.CssClasses_.IS_DIRTY)},L.prototype.checkDirty=L.prototype.checkDirty,L.prototype.disable=function(){this.input_.disabled=!0,this.updateClasses_()},L.prototype.disable=L.prototype.disable,L.prototype.enable=function(){this.input_.disabled=!1,this.updateClasses_()},L.prototype.enable=L.prototype.enable,L.prototype.change=function(e){this.input_.value=e||"",this.updateClasses_()},L.prototype.change=L.prototype.change,L.prototype.init=function(){if(this.element_&&(this.label_=this.element_.querySelector("."+this.CssClasses_.LABEL),this.input_=this.element_.querySelector("."+this.CssClasses_.INPUT),this.input_)){this.input_.hasAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE)&&(this.maxRows=parseInt(this.input_.getAttribute(this.Constant_.MAX_ROWS_ATTRIBUTE),10),isNaN(this.maxRows)&&(this.maxRows=this.Constant_.NO_MAX_ROWS)),this.input_.hasAttribute("placeholder")&&this.element_.classList.add(this.CssClasses_.HAS_PLACEHOLDER),this.boundUpdateClassesHandler=this.updateClasses_.bind(this),this.boundFocusHandler=this.onFocus_.bind(this),this.boundBlurHandler=this.onBlur_.bind(this),this.boundResetHandler=this.onReset_.bind(this),this.input_.addEventListener("input",this.boundUpdateClassesHandler),this.input_.addEventListener("focus",this.boundFocusHandler),this.input_.addEventListener("blur",this.boundBlurHandler),this.input_.addEventListener("reset",this.boundResetHandler),this.maxRows!==this.Constant_.NO_MAX_ROWS&&(this.boundKeyDownHandler=this.onKeyDown_.bind(this),this.input_.addEventListener("keydown",this.boundKeyDownHandler));var e=this.element_.classList.contains(this.CssClasses_.IS_INVALID);this.updateClasses_(),this.element_.classList.add(this.CssClasses_.IS_UPGRADED),e&&this.element_.classList.add(this.CssClasses_.IS_INVALID),this.input_.hasAttribute("autofocus")&&(this.element_.focus(),this.checkFocus())}},s.register({constructor:L,classAsString:"MaterialTextfield",cssClass:"mdl-js-textfield",widget:!0});var I=function(e){this.element_=e,this.init()};window.MaterialTooltip=I,I.prototype.Constant_={},I.prototype.CssClasses_={IS_ACTIVE:"is-active",BOTTOM:"mdl-tooltip--bottom",LEFT:"mdl-tooltip--left",RIGHT:"mdl-tooltip--right",TOP:"mdl-tooltip--top"},I.prototype.handleMouseEnter_=function(e){var t=e.target.getBoundingClientRect(),s=t.left+t.width/2,i=t.top+t.height/2,n=-1*(this.element_.offsetWidth/2),a=-1*(this.element_.offsetHeight/2);this.element_.classList.contains(this.CssClasses_.LEFT)||this.element_.classList.contains(this.CssClasses_.RIGHT)?(s=t.width/2,i+a<0?(this.element_.style.top="0",this.element_.style.marginTop="0"):(this.element_.style.top=i+"px",this.element_.style.marginTop=a+"px")):s+n<0?(this.element_.style.left="0",this.element_.style.marginLeft="0"):(this.element_.style.left=s+"px",this.element_.style.marginLeft=n+"px"),this.element_.classList.contains(this.CssClasses_.TOP)?this.element_.style.top=t.top-this.element_.offsetHeight-10+"px":this.element_.classList.contains(this.CssClasses_.RIGHT)?this.element_.style.left=t.left+t.width+10+"px":this.element_.classList.contains(this.CssClasses_.LEFT)?this.element_.style.left=t.left-this.element_.offsetWidth-10+"px":this.element_.style.top=t.top+t.height+10+"px",this.element_.classList.add(this.CssClasses_.IS_ACTIVE)},I.prototype.hideTooltip_=function(){this.element_.classList.remove(this.CssClasses_.IS_ACTIVE)},I.prototype.init=function(){if(this.element_){var e=this.element_.getAttribute("for")||this.element_.getAttribute("data-mdl-for");e&&(this.forElement_=document.getElementById(e)),this.forElement_&&(this.forElement_.hasAttribute("tabindex")||this.forElement_.setAttribute("tabindex","0"),this.boundMouseEnterHandler=this.handleMouseEnter_.bind(this),this.boundMouseLeaveAndScrollHandler=this.hideTooltip_.bind(this),this.forElement_.addEventListener("mouseenter",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("touchend",this.boundMouseEnterHandler,!1),this.forElement_.addEventListener("mouseleave",this.boundMouseLeaveAndScrollHandler,!1),window.addEventListener("scroll",this.boundMouseLeaveAndScrollHandler,!0),window.addEventListener("touchstart",this.boundMouseLeaveAndScrollHandler))}},s.register({constructor:I,classAsString:"MaterialTooltip",cssClass:"mdl-tooltip"});var f=function(e){this.element_=e,this.init()};window.MaterialLayout=f,f.prototype.Constant_={MAX_WIDTH:"(max-width: 1024px)",TAB_SCROLL_PIXELS:100,RESIZE_TIMEOUT:100,MENU_ICON:"&#xE5D2;",CHEVRON_LEFT:"chevron_left",CHEVRON_RIGHT:"chevron_right"},f.prototype.Keycodes_={ENTER:13,ESCAPE:27,SPACE:32},f.prototype.Mode_={STANDARD:0,SEAMED:1,WATERFALL:2,SCROLL:3},f.prototype.CssClasses_={CONTAINER:"mdl-layout__container",HEADER:"mdl-layout__header",DRAWER:"mdl-layout__drawer",CONTENT:"mdl-layout__content",DRAWER_BTN:"mdl-layout__drawer-button",ICON:"material-icons",JS_RIPPLE_EFFECT:"mdl_js_ripple_effect",RIPPLE_CONTAINER:"mdl-layout__tab-ripple-container",RIPPLE:"mdl-ripple",RIPPLE_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",HEADER_SEAMED:"mdl-layout__header--seamed",HEADER_WATERFALL:"mdl-layout__header--waterfall",HEADER_SCROLL:"mdl-layout__header--scroll",FIXED_HEADER:"mdl-layout--fixed-header",OBFUSCATOR:"mdl-layout__obfuscator",TAB_BAR:"mdl-layout__tab-bar",TAB_CONTAINER:"mdl-layout__tab-bar-container",TAB:"mdl-layout__tab",TAB_BAR_BUTTON:"mdl-layout__tab-bar-button",TAB_BAR_LEFT_BUTTON:"mdl-layout__tab-bar-left-button",TAB_BAR_RIGHT_BUTTON:"mdl-layout__tab-bar-right-button",TAB_MANUAL_SWITCH:"mdl-layout__tab-manual-switch",PANEL:"mdl-layout__tab-panel",HAS_DRAWER:"has-drawer",HAS_TABS:"has-tabs",HAS_SCROLLING_HEADER:"has-scrolling-header",CASTING_SHADOW:"is-casting-shadow",IS_COMPACT:"is-compact",IS_SMALL_SCREEN:"is-small-screen",IS_DRAWER_OPEN:"is-visible",IS_ACTIVE:"is-active",IS_UPGRADED:"is-upgraded",IS_ANIMATING:"is-animating",ON_LARGE_SCREEN:"mdl-layout--large-screen-only",ON_SMALL_SCREEN:"mdl-layout--small-screen-only"},f.prototype.contentScrollHandler_=function(){if(!this.header_.classList.contains(this.CssClasses_.IS_ANIMATING)){var e=!this.element_.classList.contains(this.CssClasses_.IS_SMALL_SCREEN)||this.element_.classList.contains(this.CssClasses_.FIXED_HEADER);this.content_.scrollTop>0&&!this.header_.classList.contains(this.CssClasses_.IS_COMPACT)?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.header_.classList.add(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING)):this.content_.scrollTop<=0&&this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.header_.classList.remove(this.CssClasses_.IS_COMPACT),e&&this.header_.classList.add(this.CssClasses_.IS_ANIMATING))}},f.prototype.keyboardEventHandler_=function(e){e.keyCode===this.Keycodes_.ESCAPE&&this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)&&this.toggleDrawer()},f.prototype.screenSizeHandler_=function(){this.screenSizeMediaQuery_.matches?this.element_.classList.add(this.CssClasses_.IS_SMALL_SCREEN):(this.element_.classList.remove(this.CssClasses_.IS_SMALL_SCREEN),this.drawer_&&(this.drawer_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.remove(this.CssClasses_.IS_DRAWER_OPEN)))},f.prototype.drawerToggleHandler_=function(e){if(e&&"keydown"===e.type){if(e.keyCode!==this.Keycodes_.SPACE&&e.keyCode!==this.Keycodes_.ENTER)return;e.preventDefault()}this.toggleDrawer()},f.prototype.headerTransitionEndHandler_=function(){this.header_.classList.remove(this.CssClasses_.IS_ANIMATING)},f.prototype.headerClickHandler_=function(){this.header_.classList.contains(this.CssClasses_.IS_COMPACT)&&(this.header_.classList.remove(this.CssClasses_.IS_COMPACT),this.header_.classList.add(this.CssClasses_.IS_ANIMATING))},f.prototype.resetTabState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},f.prototype.resetPanelState_=function(e){for(var t=0;t<e.length;t++)e[t].classList.remove(this.CssClasses_.IS_ACTIVE)},f.prototype.toggleDrawer=function(){var e=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);this.drawer_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.obfuscator_.classList.toggle(this.CssClasses_.IS_DRAWER_OPEN),this.drawer_.classList.contains(this.CssClasses_.IS_DRAWER_OPEN)?(this.drawer_.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true")):(this.drawer_.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"))},f.prototype.toggleDrawer=f.prototype.toggleDrawer,f.prototype.init=function(){if(this.element_){var e=document.createElement("div");e.classList.add(this.CssClasses_.CONTAINER);var s=this.element_.querySelector(":focus");this.element_.parentElement.insertBefore(e,this.element_),this.element_.parentElement.removeChild(this.element_),e.appendChild(this.element_),s&&s.focus();for(var i=this.element_.childNodes,n=i.length,a=0;a<n;a++){var l=i[a];l.classList&&l.classList.contains(this.CssClasses_.HEADER)&&(this.header_=l),l.classList&&l.classList.contains(this.CssClasses_.DRAWER)&&(this.drawer_=l),l.classList&&l.classList.contains(this.CssClasses_.CONTENT)&&(this.content_=l)}window.addEventListener("pageshow",function(e){e.persisted&&(this.element_.style.overflowY="hidden",requestAnimationFrame(function(){this.element_.style.overflowY=""}.bind(this)))}.bind(this),!1),this.header_&&(this.tabBar_=this.header_.querySelector("."+this.CssClasses_.TAB_BAR));var o=this.Mode_.STANDARD;if(this.header_&&(this.header_.classList.contains(this.CssClasses_.HEADER_SEAMED)?o=this.Mode_.SEAMED:this.header_.classList.contains(this.CssClasses_.HEADER_WATERFALL)?(o=this.Mode_.WATERFALL,this.header_.addEventListener("transitionend",this.headerTransitionEndHandler_.bind(this)),this.header_.addEventListener("click",this.headerClickHandler_.bind(this))):this.header_.classList.contains(this.CssClasses_.HEADER_SCROLL)&&(o=this.Mode_.SCROLL,e.classList.add(this.CssClasses_.HAS_SCROLLING_HEADER)),o===this.Mode_.STANDARD?(this.header_.classList.add(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.add(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.SEAMED||o===this.Mode_.SCROLL?(this.header_.classList.remove(this.CssClasses_.CASTING_SHADOW),this.tabBar_&&this.tabBar_.classList.remove(this.CssClasses_.CASTING_SHADOW)):o===this.Mode_.WATERFALL&&(this.content_.addEventListener("scroll",this.contentScrollHandler_.bind(this)),this.contentScrollHandler_())),this.drawer_){var r=this.element_.querySelector("."+this.CssClasses_.DRAWER_BTN);if(!r){r=document.createElement("div"),r.setAttribute("aria-expanded","false"),r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.classList.add(this.CssClasses_.DRAWER_BTN);var _=document.createElement("i");_.classList.add(this.CssClasses_.ICON),_.innerHTML=this.Constant_.MENU_ICON,r.appendChild(_)}this.drawer_.classList.contains(this.CssClasses_.ON_LARGE_SCREEN)?r.classList.add(this.CssClasses_.ON_LARGE_SCREEN):this.drawer_.classList.contains(this.CssClasses_.ON_SMALL_SCREEN)&&r.classList.add(this.CssClasses_.ON_SMALL_SCREEN),r.addEventListener("click",this.drawerToggleHandler_.bind(this)),r.addEventListener("keydown",this.drawerToggleHandler_.bind(this)),this.element_.classList.add(this.CssClasses_.HAS_DRAWER),this.element_.classList.contains(this.CssClasses_.FIXED_HEADER)?this.header_.insertBefore(r,this.header_.firstChild):this.element_.insertBefore(r,this.content_);var d=document.createElement("div");d.classList.add(this.CssClasses_.OBFUSCATOR),this.element_.appendChild(d),d.addEventListener("click",this.drawerToggleHandler_.bind(this)),this.obfuscator_=d,this.drawer_.addEventListener("keydown",this.keyboardEventHandler_.bind(this)),this.drawer_.setAttribute("aria-hidden","true")}if(this.screenSizeMediaQuery_=window.matchMedia(this.Constant_.MAX_WIDTH),this.screenSizeMediaQuery_.addListener(this.screenSizeHandler_.bind(this)),this.screenSizeHandler_(),this.header_&&this.tabBar_){this.element_.classList.add(this.CssClasses_.HAS_TABS);var h=document.createElement("div");h.classList.add(this.CssClasses_.TAB_CONTAINER),this.header_.insertBefore(h,this.tabBar_),this.header_.removeChild(this.tabBar_);var c=document.createElement("div");c.classList.add(this.CssClasses_.TAB_BAR_BUTTON),c.classList.add(this.CssClasses_.TAB_BAR_LEFT_BUTTON);var p=document.createElement("i");p.classList.add(this.CssClasses_.ICON),p.textContent=this.Constant_.CHEVRON_LEFT,c.appendChild(p),c.addEventListener("click",function(){this.tabBar_.scrollLeft-=this.Constant_.TAB_SCROLL_PIXELS}.bind(this));var C=document.createElement("div");C.classList.add(this.CssClasses_.TAB_BAR_BUTTON),C.classList.add(this.CssClasses_.TAB_BAR_RIGHT_BUTTON);var u=document.createElement("i");u.classList.add(this.CssClasses_.ICON),u.textContent=this.Constant_.CHEVRON_RIGHT,C.appendChild(u),C.addEventListener("click",function(){this.tabBar_.scrollLeft+=this.Constant_.TAB_SCROLL_PIXELS}.bind(this)),h.appendChild(c),h.appendChild(this.tabBar_),h.appendChild(C);var E=function(){this.tabBar_.scrollLeft>0?c.classList.add(this.CssClasses_.IS_ACTIVE):c.classList.remove(this.CssClasses_.IS_ACTIVE),this.tabBar_.scrollLeft<this.tabBar_.scrollWidth-this.tabBar_.offsetWidth?C.classList.add(this.CssClasses_.IS_ACTIVE):C.classList.remove(this.CssClasses_.IS_ACTIVE)}.bind(this);this.tabBar_.addEventListener("scroll",E),E();var m=function(){this.resizeTimeoutId_&&clearTimeout(this.resizeTimeoutId_),this.resizeTimeoutId_=setTimeout(function(){E(),this.resizeTimeoutId_=null}.bind(this),this.Constant_.RESIZE_TIMEOUT)}.bind(this);window.addEventListener("resize",m),this.tabBar_.classList.contains(this.CssClasses_.JS_RIPPLE_EFFECT)&&this.tabBar_.classList.add(this.CssClasses_.RIPPLE_IGNORE_EVENTS);for(var L=this.tabBar_.querySelectorAll("."+this.CssClasses_.TAB),I=this.content_.querySelectorAll("."+this.CssClasses_.PANEL),f=0;f<L.length;f++)new t(L[f],L,I,this)}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}},window.MaterialLayoutTab=t,s.register({constructor:f,classAsString:"MaterialLayout",cssClass:"mdl-js-layout"});var b=function(e){this.element_=e,this.init()};window.MaterialDataTable=b,b.prototype.Constant_={},b.prototype.CssClasses_={DATA_TABLE:"mdl-data-table",SELECTABLE:"mdl-data-table--selectable",SELECT_ELEMENT:"mdl-data-table__select",IS_SELECTED:"is-selected",IS_UPGRADED:"is-upgraded"},b.prototype.selectRow_=function(e,t,s){return t?function(){e.checked?t.classList.add(this.CssClasses_.IS_SELECTED):t.classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):s?function(){var t,i;if(e.checked)for(t=0;t<s.length;t++)i=s[t].querySelector("td").querySelector(".mdl-checkbox"),i.MaterialCheckbox.check(),s[t].classList.add(this.CssClasses_.IS_SELECTED);else for(t=0;t<s.length;t++)i=s[t].querySelector("td").querySelector(".mdl-checkbox"),i.MaterialCheckbox.uncheck(),s[t].classList.remove(this.CssClasses_.IS_SELECTED)}.bind(this):void 0},b.prototype.createCheckbox_=function(e,t){var i=document.createElement("label"),n=["mdl-checkbox","mdl-js-checkbox","mdl_js_ripple_effect",this.CssClasses_.SELECT_ELEMENT];i.className=n.join(" ");var a=document.createElement("input");return a.type="checkbox",a.classList.add("mdl-checkbox__input"),e?(a.checked=e.classList.contains(this.CssClasses_.IS_SELECTED),a.addEventListener("change",this.selectRow_(a,e))):t&&a.addEventListener("change",this.selectRow_(a,null,t)),i.appendChild(a),s.upgradeElement(i,"MaterialCheckbox"),i},b.prototype.init=function(){if(this.element_){var e=this.element_.querySelector("th"),t=Array.prototype.slice.call(this.element_.querySelectorAll("tbody tr")),s=Array.prototype.slice.call(this.element_.querySelectorAll("tfoot tr")),i=t.concat(s);if(this.element_.classList.contains(this.CssClasses_.SELECTABLE)){var n=document.createElement("th"),a=this.createCheckbox_(null,i);n.appendChild(a),e.parentElement.insertBefore(n,e);for(var l=0;l<i.length;l++){var o=i[l].querySelector("td");if(o){var r=document.createElement("td");if("TBODY"===i[l].parentNode.nodeName.toUpperCase()){var _=this.createCheckbox_(i[l]);r.appendChild(_)}i[l].insertBefore(r,o)}}this.element_.classList.add(this.CssClasses_.IS_UPGRADED)}}},s.register({constructor:b,classAsString:"MaterialDataTable",cssClass:"mdl-js-data-table"});var S=function(e){this.element_=e,this.init()};window.MaterialRipple=S,S.prototype.Constant_={INITIAL_SCALE:"scale(0.0001, 0.0001)",INITIAL_SIZE:"1px",INITIAL_OPACITY:"0.4",FINAL_OPACITY:"0",FINAL_SCALE:""},S.prototype.CssClasses_={RIPPLE_CENTER:"mdl-ripple--center",RIPPLE_EFFECT_IGNORE_EVENTS:"mdl_js_ripple_effect--ignore-events",RIPPLE:"mdl-ripple",IS_ANIMATING:"is-animating",IS_VISIBLE:"is-visible"},S.prototype.downHandler_=function(e){if(!this.rippleElement_.style.width&&!this.rippleElement_.style.height){var t=this.element_.getBoundingClientRect();this.boundHeight=t.height,this.boundWidth=t.width,this.rippleSize_=2*Math.sqrt(t.width*t.width+t.height*t.height)+2,this.rippleElement_.style.width=this.rippleSize_+"px",this.rippleElement_.style.height=this.rippleSize_+"px"}if(this.rippleElement_.classList.add(this.CssClasses_.IS_VISIBLE),"mousedown"===e.type&&this.ignoringMouseDown_)this.ignoringMouseDown_=!1;else{"touchstart"===e.type&&(this.ignoringMouseDown_=!0);var s=this.getFrameCount();if(s>0)return;this.setFrameCount(1);var i,n,a=e.currentTarget.getBoundingClientRect();if(0===e.clientX&&0===e.clientY)i=Math.round(a.width/2),n=Math.round(a.height/2);else{var l=void 0!==e.clientX?e.clientX:e.touches[0].clientX,o=void 0!==e.clientY?e.clientY:e.touches[0].clientY;i=Math.round(l-a.left),n=Math.round(o-a.top)}this.setRippleXY(i,n),this.setRippleStyles(!0),window.requestAnimationFrame(this.animFrameHandler.bind(this))}},S.prototype.upHandler_=function(e){e&&2!==e.detail&&window.setTimeout(function(){this.rippleElement_.classList.remove(this.CssClasses_.IS_VISIBLE)}.bind(this),0)},S.prototype.init=function(){if(this.element_){var e=this.element_.classList.contains(this.CssClasses_.RIPPLE_CENTER);this.element_.classList.contains(this.CssClasses_.RIPPLE_EFFECT_IGNORE_EVENTS)||(this.rippleElement_=this.element_.querySelector("."+this.CssClasses_.RIPPLE),this.frameCount_=0,this.rippleSize_=0,this.x_=0,this.y_=0,this.ignoringMouseDown_=!1,this.boundDownHandler=this.downHandler_.bind(this),this.element_.addEventListener("mousedown",this.boundDownHandler),this.element_.addEventListener("touchstart",this.boundDownHandler),this.boundUpHandler=this.upHandler_.bind(this),this.element_.addEventListener("mouseup",this.boundUpHandler),this.element_.addEventListener("mouseleave",this.boundUpHandler),this.element_.addEventListener("touchend",this.boundUpHandler),this.element_.addEventListener("blur",this.boundUpHandler),this.getFrameCount=function(){return this.frameCount_},this.setFrameCount=function(e){this.frameCount_=e},this.getRippleElement=function(){return this.rippleElement_},this.setRippleXY=function(e,t){this.x_=e,this.y_=t},this.setRippleStyles=function(t){if(null!==this.rippleElement_){var s,i,n,a="translate("+this.x_+"px, "+this.y_+"px)";t?(i=this.Constant_.INITIAL_SCALE,n=this.Constant_.INITIAL_SIZE):(i=this.Constant_.FINAL_SCALE,n=this.rippleSize_+"px",e&&(a="translate("+this.boundWidth/2+"px, "+this.boundHeight/2+"px)")),s="translate(-50%, -50%) "+a+i,this.rippleElement_.style.webkitTransform=s,this.rippleElement_.style.msTransform=s,this.rippleElement_.style.transform=s,t?this.rippleElement_.classList.remove(this.CssClasses_.IS_ANIMATING):this.rippleElement_.classList.add(this.CssClasses_.IS_ANIMATING)}},this.animFrameHandler=function(){this.frameCount_-- >0?window.requestAnimationFrame(this.animFrameHandler.bind(this)):this.setRippleStyles(!1)})}},s.register({constructor:S,classAsString:"MaterialRipple",cssClass:"mdl_js_ripple_effect",widget:!1})}();
var animations;$.getJSON("/workpadentry/workpadentry_animate/animations",function(data){animations=data});const animateElement=(elementSelector,animation,prefix="animate__")=>new Promise((resolve,reject)=>{const animationName=`${prefix}${animation}`;const node=document.querySelector(elementSelector);node.classList.add(`${prefix}animated`,animationName);function handleAnimationEnd(event){event.stopPropagation();node.classList.remove(`${prefix}animated`,animationName);resolve("Animation ended")}node.addEventListener("animationend",handleAnimationEnd,{once:true})});function animateWorkpadEntry(direction){direction=typeof direction!=="undefined"?direction:"in";var $resultDiv=$(this);var workpadEntryId=$resultDiv.data("id");var workpadEntry=workpadEntries[workpadEntryId];$resultDiv.removeClass("animating-in");if(workpadEntry["animate_event"]!=="narrate"){$resultDiv.css("animation-delay",workpadEntry.animate_delay+"s")}$resultDiv.addClass(workpadEntry.animate_speed?"animate__"+workpadEntry.animate_speed:"");return animateElement("#"+$resultDiv.attr("id"),animations[workpadEntry.animation][direction]).then(function(){$resultDiv.addClass("animated-"+direction)})}var narrationEntries;function animateWorkpadEntries(currentPage,event){if(isLoading()){return Promise.resolve()}narrationEntries=[];var promises=[];getAnimatedElementsByPage(currentPage).each(function(){var $resultDiv=$(this);var repeat=$resultDiv.data("animate-repeat");if(typeof $resultDiv.attr("id")==="undefined"||$resultDiv.attr("id").indexOf(PF5_PREFIX)===0)return;var workpadEntry=workpadEntries[$resultDiv.data("id")];if(workpadEntry&&workpadEntry["animate_event"]){if(workpadEntry["animate_event"].indexOf(event)>=0){var direction=event==="close"||repeat===-1?"out":"in";promises.push(animateWorkpadEntry.call(this,direction))}else if(workpadEntry["animate_event"]==="narrate"){narrationEntries.push($resultDiv)}}});var $narrationObjects=$(".narration-object");if(narrationEntries.length&&$narrationObjects.length){$narrationObjects.bind("timeupdate",function(event){var narrationObject=this;narrationEntries.map(function($resultDiv){var workpadEntry=workpadEntries[$resultDiv.data("id")];if(Math.floor(narrationObject.currentTime)===+workpadEntry.animate_delay){animateWorkpadEntry.call($resultDiv.get(0),$resultDiv.data("animation")==="hinge"?"out":"in")}})})}return Promise.all(promises)}function animateNarrationEntries(event){console.log("animateNarrationEntries: ",event)}function animateWorkpadEntryAddEvents(){$(document).on("click",".animate-click",function(){var repeat=$(this).data("animate-repeat");animateWorkpadEntry.call(this,repeat===-1?"out":"in")});$(document).on("mouseenter",".animate-hover",function(){var repeat=$(this).data("animate-repeat");animateWorkpadEntry.call(this,repeat===-1?"out":"in")})}function hideAnimatingIn(page){if(editMode())return;getAnimatedElementsByPage(page).each(function(){if(this.className.match(/animate-open|narrate/)){if($(this).data("animation")!=="hinge"){$(this).addClass("animating-in")}}})}function getAnimatedElementsByPage(page){if(isTrifold()||isGatefold()){return $(".resultDiv.animate")}else{return $(".resultDiv.animate.page-"+page+(isPageSpread()?",.resultDiv.animate.page-"+(+page-1):""))}}
function workpadSearch(){$(".action-workpad-search-noresults").hide();$(".action-workpad-searchresult").remove();var searchPhrase=$("input[name=workpadSearch]").val();if(!searchPhrase.length){return false}$(".action-workpad-search-spinner").show();$.ajax({url:"/workpad/workpad_public/search",data:{workpad_key:W["workpad_key"],query:searchPhrase}}).then(function(response){if(response.status==="ok"){var matchedPages=response.data;if(matchedPages.length){loadPages(matchedPages).then(function(){renderMatchedPages(matchedPages)})}else{$(".action-workpad-search-spinner").hide();$(".action-workpad-search-noresults").show()}}else{modalToast(response.message)}});return false}function renderMatchedPages(matchedPages){$(".action-workpad-search-spinner").hide();matchedPages.map(function(pageNumber){var $page=$(".pageDiv.page-"+pageNumber);renderSearchResultsByPage($page)})}function renderSearchResultsByPage($page){var pageNumber=+$page.attr("page");var $resultNode=$("<div class='mdl-grid mdl-grid--100 mdl-cell--flex-row-reverse action-workpad-searchresult workpad-searchresult-list toc-row' data-search_result_page='"+pageNumber+"'><div class='mdl-cell mdl-cell--flex mdl-cell--flex-between mdl-cell--middle mdl-cell--3-col mdl-cell--1-col-phone'><p class='mdl-cell--middle' style='margin: 0;'>pg</p><h6>"+(1+pageNumber)+"</h6></div></div>");var $resultNodePreview=$("<div class='mdl-cell mdl-cell--middle mdl-cell--9-col  mdl-cell--3-col-phone preview-bookletsearchresults'></div>");$resultNode.appendTo($(".action-workpad-searchresults"));$resultNodePreview.appendTo($resultNode);$page.workpadPagePreview($resultNodePreview,true)}$(document).on("click",".action-workpad-search",function(){return workpadSearch()});$(document).on("click",".action-workpad-searchresult",function(e){e.preventDefault();var pageNumber=$(this).data("search_result_page");gotoPage(pageNumber,true);if(MOBILE){modalClose()}return false});
function logoutSessionPublish(){return $.ajax({url:"/account/account_session/logout",data:{workpad_key:W["key"]},type:"POST"})}$(document).on("click",".action-publish-logout",function(){logoutSessionPublish().then(function(response){if(response.status=="ok"){var $node=$("<img src='https://"+BASE_DOMAIN+"/account/account_session/logout' style='width: 0; height: 0;'/>");if(typeof feedbackLoggedOut==="function")feedbackLoggedOut();if(response.data["reload"]=="1")window.location.reload()}else{window.location.reload()}})});
